(()=>{var Pe=Object.defineProperty;var He=(e,t,r)=>t in e?Pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var qt=(e,t,r)=>(He(e,typeof t!="symbol"?t+"":t,r),r);var b=e=>e!==null&&typeof e=="object"&&!Array.isArray(e),h=e=>typeof e=="function",B=e=>Array.isArray(e),S=e=>typeof e=="string";var O=e=>e===void 0,z=e=>e instanceof Element;var ut=(e,t)=>JSON.stringify(e)===JSON.stringify(t);function T(e,t={},...r){Ut("Warning",e,t,...r)}function c(e,t={}){let r=typeof e=="string"?e:e.message||"Unknown error",o={message:r,...t};setTimeout(()=>Ut("Error",r,o),0)}function lt(e,t={},...r){let{el:o,expression:n,message:i="",defaultValue:s=null,rethrow:a=!1,onError:f}=t;try{return e(...r)}catch(l){let p=`${i}
${l.message}`;if(c(p,{el:o,expression:n}),f&&h(f)&&f(l,{el:o,expression:n,message:i}),a)throw l;return s}}function Ut(e,t,r={},...o){let{el:n,expression:i,component:s}=r,a=new Date().toISOString(),f={message:t,el:n,expression:i,component:s,timestamp:a,additionalInfo:o},l=e.toLowerCase()==="error"?"#FF0000":"#FFA500";console.groupCollapsed(`%c[Asor ${e}]: ${t}`,`color: ${l}; font-weight: bold;`),console.log(f),console.groupCollapsed("Stack Trace"),console.trace(),console.groupEnd()}var dt=new Map,y=(e,t,r,o={})=>{let n=dt.get(t);n||(n=new Set,dt.set(t,n)),n.add(r);let i=new AbortController;return e.addEventListener(t,r,{...o,signal:i.signal}),()=>{i.abort(),n.delete(r),n.size===0&&dt.delete(t)}},d=(e,t,r,o={})=>{let n=new CustomEvent(t,{bubbles:!0,cancelable:!0,...o,detail:r});return n.__asor={name:t,detail:r,receivedBy:[]},e.dispatchEvent(n)},kt=(e,t)=>y(window,e,r=>r.__asor&&t(r)),Vt=(e,t)=>d(window,e,t),Wt=(e,t,r)=>d(e,t,r,{bubbles:!1});var jt=(e,t)=>{for(;e&&e!==document.body;){if(t(e))return e;e=e.parentElement}return null},Bt=e=>document.querySelector(`meta[name='${e}']`)?.getAttribute("content")||"";var zt=e=>jt(e,t=>t.hasAttribute("a-def"))||document.body,Xt=e=>jt(e,t=>t.dataset&&Object.keys(t.dataset).length>0||t.hasAttribute("a-def"))||document.body;var mt=e=>e.tagName==="FORM";var Kt=(e,t)=>window.getComputedStyle(e).getPropertyValue(t);var Jt=(e=36)=>Math.random().toString(e).substring(2,10);function I(e=document.body,t=["a-","@",":"]){let r=[],o=document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>Array.from(i.attributes).some(s=>t.some(a=>s.name.startsWith(a)))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}),n;for(;n=o.nextNode();)r.push(n);return r}var L=new WeakMap,E="data-a-",Yt=e=>Array.from(e.attributes).find(t=>t.name.startsWith(E))?.name||null,w=(e,t)=>z(e)?b(t)?(ut(L.get(e),t)||(L.set(e,t),e.__asor_def=t,Qt(e)),t):(c(`${t} must be a valid object`,e),null):(c("The element is not a valid HTML element",e),null);function g(e){for(;e;){if(e.__asor_def)return e.__asor_def;e=e.parentElement}return{}}var X=e=>{L.delete(e);let t=Yt(e);t&&e.removeAttribute(t),delete e.__asor_def};function _(e){try{if(!L.get(e))return;Qt(e)}catch(t){c("Error updating data for element",e,t)}}function Gt(e){try{let t=L.get(e),r=e.__asor_def;qe(t,r)&&L.set(e,{...r})}catch(t){c("Error updating data for element",e,t)}}var qe=(e,t)=>!ut(e,t);function Qt(e){try{(()=>{let r=Jt(),o=Yt(e);o&&e.removeAttribute(o),e.setAttribute(`${E}${r}`,"")})()}catch(t){c("Error serializing data for element",e,t)}}var Zt=new WeakMap,ee=new Map,pt=new Map;function Ue(e){let t=e.join("|");return pt.has(t)||pt.set(t,new RegExp(`^(?:${t})([^\\s.:]+)(?:\\.[^\\s.:]+)*(?::[^\\s]+)?\\s*`)),pt.get(t)}var ke=e=>{if(!e)throw new Error("Directive name is required");return e.startsWith(":")?`a-bind:${e.slice(1)}`:e.startsWith("@")?`a-on:${e.slice(1)}`:e.startsWith("a-")?e:`a-${e}`},u=(e,t)=>ee.set(e,t),re=()=>I().forEach(J);function J(e){if(!e)return c(`Undefined element: ${e}`);let t=K(e);t.directives.sort((r,o)=>te.get(r.name)-te.get(o.name)).forEach(r=>{let o=ee.get(r.name);o&&o({el:e,directive:r,manager:t})})}var oe=e=>Array.from(e.attributes).some(t=>t.name.startsWith(":")||t.name.startsWith("@")||t.name.startsWith("a-")),K=e=>{let t=Zt.get(e);if(!t){let r=We(e);t={el:e,directives:r,hasDirective:o=>r.some(n=>n.name===o),getDirective:o=>r.find(n=>n.name===o),delDirective:o=>t.directives=t.directives.filter(n=>n.name!==o)},Zt.set(e,t)}return t},Ve=["ref","def","bind","init","confirm","xhr","on","effect","show","navigate","transition","for","if","loading","offline","stream"],te=new Map(Ve.map((e,t)=>[e,t])),m=(e,t)=>{let r=K(e).getDirective(t);return r?{...r,name:t}:null},We=e=>{if(!e?.attributes)return c("Invalid element in extractDirectives"),[];let t=Ue(["a-","@",":"]);return Array.from(e.attributes).filter(r=>t.test(r.name)).map(({name:r,value:o})=>je(e,r,o))},je=(e,t,r)=>{let o=ke(t),{directiveName:n,directiveValue:i}=Be(o),s=ze(t);return{el:e,name:n,fullName:o,expression:r,value:i,modifiers:s,hasModifier:a=>s.has(a),getModifierValue:a=>s.get(a),getAllModifiers:()=>Array.from(s,([a,f])=>({name:a,value:f})),hasModifiers:()=>s.size>0,firstModifier:()=>{let[a,f]=s.entries().next().value||[];return a?{name:a,value:f}:null}}},Be=e=>{let t=/^a-(?:(on):)?([^:.]+)(?::([^.]+))?/,[,r,o,n]=e.match(t)||[];return{directiveName:r||o,directiveValue:r?o:n}},ze=e=>{let t=e.match(/\.[^.\]]+(?=[^\]]*$)/g)||[];return new Map(t.map(r=>{let[o,n]=r.slice(1).split("-");return[o,n===void 0?!0:n]}))};async function ne(e,t){let r=I(e),o=I(t);r.forEach(n=>{let i=o.find(s=>s.isEqualNode(n));if(!i||!Xe(n,i))J(n);else{let s=g(i);s&&w(n,s)}})}function Xe(e,t){let r=K(e),o=K(t);return r.directives.length!==o.directives.length?!1:r.directives.every((n,i)=>{let s=o.directives[i];return n.name===s.name&&n.expression===s.expression})}var ie={CHILD_LIST:"childList",ATTRIBUTES:"attributes"},H={elementAdded:new Set,elementRemoved:new Set,attributeChanged:new Set},G=null,q=!1,Q=!1,ht=class{constructor(){this.addedNodes=new Set,this.removedNodes=new Set,this.changedAttributes=new Map}add(t){if(t.type===ie.CHILD_LIST)t.addedNodes.forEach(r=>r.nodeType===Node.ELEMENT_NODE&&this.addedNodes.add(r)),t.removedNodes.forEach(r=>r.nodeType===Node.ELEMENT_NODE&&this.removedNodes.add(r));else if(t.type===ie.ATTRIBUTES&&t.attributeName.startsWith(E)){let r=t.target.getAttribute(t.attributeName);t.oldValue!==r&&this.changedAttributes.set(t.target,{attributeName:t.attributeName,oldValue:t.oldValue,newValue:r})}}process(t){let r=(n,i)=>{for(let s of n){if(t.timeRemaining()<=0&&!t.didTimeout)return!1;i(s),n.delete(s)}return!0},o=()=>{for(let[n,{attributeName:i,oldValue:s,newValue:a}]of this.changedAttributes){if(t.timeRemaining()<=0&&!t.didTimeout)return!1;H.attributeChanged.forEach(f=>Y(f,n,i,s,a)),Y(()=>Gt(n)),this.changedAttributes.delete(n)}return!0};return r(this.addedNodes,n=>H.elementAdded.forEach(i=>Y(i,n)))&&r(this.removedNodes,n=>H.elementRemoved.forEach(i=>Y(i,n)))&&o()}isEmpty(){return this.addedNodes.size===0&&this.removedNodes.size===0&&this.changedAttributes.size===0}},$=new ht,Ke=()=>{if(Q)return;Q=!0;let e=t=>{$.process(t)?Q=!1:requestIdleCallback(e)};requestIdleCallback(e)},Je=e=>{e.forEach(t=>$.add(t)),$.isEmpty()||Ke()},Y=(e,...t)=>{try{e(...t)}catch(r){c("Error in mutation observer callback:",e.toString(),r)}},gt=()=>{q||!document||(G||(G=new MutationObserver(Je)),G.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),q=!0)},yt=()=>{q&&(G.disconnect(),q=!1)},xt=e=>t=>{if(h(t))return H[e].add(t),()=>H[e].delete(t);c(`Invalid callback provided to on${e.charAt(0).toUpperCase()+e.slice(1)}`)},fo=xt("elementAdded"),Z=xt("elementRemoved"),R=xt("attributeChanged"),v=e=>{let t=q;t&&yt();try{e()}finally{t&&gt()}},se=()=>{$.addedNodes.clear(),$.removedNodes.clear(),$.changedAttributes.clear(),Q=!1};var F=new WeakMap,vt=new Set,tt=!1;function et(e,t){return F.has(e)||F.set(e,new Set),F.get(e).add(t),()=>{let r=F.get(e);r&&(r.delete(t),r.size===0&&F.delete(e))}}function rt(e){vt.add(e),Ye()}function Ye(){tt||(tt=!0,queueMicrotask(()=>Ge()),tt=!1)}function Ge(){vt.forEach(e=>{_(e);let t=F.get(e);t&&t.forEach(r=>r())}),vt.clear(),tt=!1}var ae="asor_persist_";function ce(e,t){let r=e.uniqueId||ae+e,o=localStorage.getItem(r);if(o===null)return t;try{return JSON.parse(o)}catch(n){return T(`Error parsing stored value for key ${e}:`,n),t}}function bt(e,t){let r=e.uniqueId||ae+e;try{localStorage.setItem(r,JSON.stringify(t))}catch(o){c(`Error storing value for key ${e}:`,o)}}var U=new WeakMap;function Et(e,t){if((!e||!b(e))&&(e={}),U.has(e))return U.get(e);let r=er(e,t),o=new Proxy(r,Qe(t));return U.set(e,o),o}function Qe(e){return{get(t,r,o){let n=Reflect.get(t,r,o);return n&&n.__isPersist?n.value:h(n)&&!r.startsWith("__")?Ze(n,e,o):n},set(t,r,o,n){if(tr(t,r,o,e))return!0;let i=t[r];return Reflect.set(t,r,o,n),i!==o&&rt(e),!0}}}function Ze(e,t,r){return function(...o){let n=e.apply(r,o);return rt(t),n}}function tr(e,t,r,o){if(e[t]&&e[t].__isPersist){let n=e[t].value;return e[t].value=r,bt(t,r),n!==r&&rt(o),!0}return!1}function er(e,t){let r={};return rr(e,r),or(e,r,t),r}function rr(e,t){Object.keys(e).forEach(r=>{let o=Object.getOwnPropertyDescriptor(e,r);o&&typeof o.get=="function"&&Object.defineProperty(t,r,{get:o.get.bind(t),enumerable:!0,configurable:!0})})}function or(e,t,r){Object.entries(e).forEach(([o,n])=>{n&&n.__isPersist?t[o]=nr(o,n):b(n)?t[o]=Et(n,r):h(n)?t[o]=n:t[o]||(t[o]=n)})}function nr(e,t){let r=ce(e,t.initialValue);return r==null&&(r=t.initialValue),bt(e,r),{__isPersist:!0,value:r}}function fe(e){let t=g(e);t&&U.has(t)&&U.delete(t)}var ot=!1;function ue(e=!1){if(ot&&!e){T("Asor is already initialized. Skipping re-initialization.");return}wt();let t=()=>{se(),d(document,"asor:init"),d(document,"asor:initializing"),requestAnimationFrame(()=>{gt(),re(),ot=!0,d(document,"asor:initialized")})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()}function wt(e=null){!ot||(yt(),ir(),window.asor&&delete window.asor,e&&h(e)&&e(),d(document,"asor:stopped"),ot=!1)}function ir(){document.querySelectorAll("*").forEach(e=>{Array.from(e.attributes).filter(r=>r.name.startsWith(E)).forEach(r=>e.removeAttribute(r.name)),fe(e)})}var Dt={parseInt,parseFloat,isNaN,isFinite,encodeURIComponent,decodeURIComponent,encodeURI,decodeURI};function le(e,t={}){let r=zt(e),o=g(e)||g(r)||{},n=r._asor_refs||{},i={$el:e,$event:t.$event||{},$refs:n,$root:{...r,dataset:r?{...r.dataset}:{}},$dispatch:(s,a)=>d(e,s,a),$persist:s=>({__isPersist:!0,initialValue:s})};return{...i,$data:new Proxy(o,{get(s,a){if(a in s)return s[a];if(a in i)return i[a];if(a in t)return t[a];if(a in Dt)return Dt[a]}}),...Dt,...t}}var k=new Map,sr=500,ar=(e,t)=>({el:e,expression:t,rethrow:!1,defaultValue:null,message:`Error evaluating expression: "${t}"`}),cr=e=>`
    with (__context) {
        with ($data) {
            return (${e});
        }
    }
`,fr=e=>`
    try {
        ${e}
    } catch (e) {
        if (e instanceof ReferenceError) return undefined;
        throw e;
    }
`,ur=e=>{let t=cr(e),r=fr(t);return new Function("__context",r)},lr=(e,t)=>{let r=Object.keys(t).sort().join(",");return`${e}::${r}`},dr=(e,t)=>{if(k.size>=sr){let r=k.keys().next().value;k.delete(r)}k.set(e,t)};function Tt(e,t,r){let o=ar(e,t);if(h(t))return lt(t,o,r);if(!S(t))return c(`Invalid expression type: ${typeof t}. Expected string or function.`,e,t),null;let n=le(e,r),i=lr(t,n),s=k.get(i);return s||(s=ur(t),dr(i,s)),lt(()=>s(n),o)}var x=(e,t,r={})=>Tt(e,t,r);u("ref",({el:e,directive:t})=>{let r=t.expression?.trim();if(!r)return;let o=s=>{let a=Xt(e);if(a._asor_refs||(a._asor_refs={}),s(a._asor_refs),a!==document.documentElement){let f=g(a)||{};f.$refs=a._asor_refs,w(a,f)}},n=()=>o(s=>s[r]=e),i=()=>o(s=>delete s[r]);return n(),Z(s=>{z(s)&&s===e&&i()})});var de=(e,t)=>{if(b(e))return e;if(!S(e)||!e.trim())return{};try{let r=Tt(t,`(${e})`,{});if(b(r))return r;c(`Invalid data attribute: ${e}`,t,e)}catch(r){return c(`Error parsing data attribute: ${r.message}`,t,e),{}}};function me(e){let t=e.match(/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/);if(!t)return null;let[,r,o]=t,n=r.replace(/^\(|\)$/g,"").split(",").map(i=>i.trim());return n.length===1?{item:n[0],items:o.trim()}:n.length===2?{item:n[0],key:n[1],items:o.trim()}:n.length===3?{item:n[0],key:n[1],index:n[2],items:o.trim()}:null}u("def",({el:e,directive:t})=>{try{let r=t.expression?.trim();r=r===""?"{}":r;let o=de(r,e),n=Et(o,e);return w(e,n),_(e),()=>X(e)}catch(r){c("Error in a-def directive:",r,e)}});var mr={text:e=>e.textContent,html:e=>e.innerHTML,value:e=>e.value,checked:e=>e.checked,selected:e=>e.selected,class:e=>e.className},pr=new Map([["text",(e,t)=>e.textContent=t??""],["html",(e,t)=>e.innerHTML=t??""],["value",(e,t)=>{e.value!==t&&(e.value=t??"")}],["checked",(e,t)=>e.checked=!!t],["disabled",(e,t)=>e.disabled=!!t],["readonly",(e,t)=>e.readOnly=!!t],["required",(e,t)=>e.required=!!t],["multiple",(e,t)=>e.multiple=!!t],["hidden",(e,t)=>e.hidden=!!t],["radio",(e,t)=>e.checked=e.value==t],["open",(e,t)=>e.open=!!t],["class",yr],["style",xr],["selected",Er],["multipleSelect",he],["contenteditable",(e,t)=>{e.innerHTML!==t&&(e.innerHTML=t)}],["number",(e,t)=>{e.value=t==null?"":Number(t)}]]);function pe(e,t,r){if(!e)return;if(e.tagName==="SELECT"&&e.multiple&&t==="value"){he(e,r);return}let o=hr(e,t);Object.is(o,r)||gr(e,t,r)}function hr(e,t){return mr[t]?.(e)??e.getAttribute(t)}function gr(e,t,r){(pr.get(t)||((o,n)=>o.setAttribute(t,n??"")))(e,r)}function yr(e,t){if(S(t))e.className=t;else if(B(t))e.className=t.join(" ");else if(b(t))for(let[r,o]of Object.entries(t))r.includes(" ")?r.split(" ").forEach(n=>{e.classList.toggle(n.trim(),!!o)}):e.classList.toggle(r,!!o)}function xr(e,t){S(t)?e.style.cssText=t:b(t)&&Object.assign(e.style,t)}function vr(e,t,r){let o=br(e,r),n=e.closest("[a-def]");if(!n)return;let i=g(n);if(i){let s={...i,[t]:o};w(n,s),_(n)}}function br(e,t){return e.tagName==="SELECT"&&e.multiple?Array.from(e.selectedOptions).map(r=>r.value):e.type==="date"||e.type==="datetime-local"?e.valueAsDate:e.type==="checkbox"?t.target.checked:e.type==="file"?e.multiple?Array.from(e.files):e.files[0]:t.target.value}function Er(e,t){let r=Array.from(e.options);if(B(t))r.forEach(o=>o.selected=t.includes(o.value));else{let o=r.find(n=>n.value==t);o&&(o.selected=!0,e.value=o.value)}}function he(e,t){B(t)||(t=[t]),Array.from(e.options).forEach(r=>r.selected=t.includes(r.value))}function ge(e,t){if(["INPUT","TEXTAREA","SELECT"].includes(e.tagName)){let r=e.type==="checkbox"||e.type==="radio"||e.type==="file"?"change":"input";return y(e,r,o=>vr(e,t,o))}return null}u("bind",({el:e,directive:t})=>{let r=t.value||"text",o=t.expression;if(!o){c("Empty bind expression",null,e);return}let n=async()=>{let s=g(e),a=await x(e,o,{data:s});O(a)||v(async()=>{pe(e,r,a),ge(e,o)})};n();let i=R((s,a)=>{s.contains(e)&&a.startsWith(E)&&n()});return()=>i});u("init",({el:e,directive:t})=>{let r=t.expression?.trim();if(!r)return;let o=e.__asor_def||g(e);if(!o){c("No data found for a-init directive:",e);return}(async()=>await x(e,r,{data:o,$el:e}))()});u("effect",({el:e,directive:t})=>{let r=t.expression,o=async()=>{let s=e.__asor_def||g(e);if(!s)return;let a=await x(e,r,{data:s});if(h(a))return await a()},n,i=async()=>{n&&(n(),n=null);let s=await o();h(s)&&(n=s)};return i(),et(e,i)});u("confirm",({el:e,directive:t})=>{let r=t.expression,o=t.hasModifier("prompt");r=r.replaceAll("\\n",`
`),r===""&&(r="Are you sure?");let n=(i,s,a)=>{i?s():a()};e.__confirm_action=(i,s)=>{if(o){let[a,f]=r.split("|");f||c("Directives: You must provide an expectation with @confirm.prompt.");let l=prompt(a);n(l===f,i,s)}else n(confirm(r),i,s)}});function xe(e){let t=document.getElementById("asor-error");t||(t=document.createElement("div"),t.id="asor-error",t.style.cssText=`
            position: fixed;
            width: 100vw;
            height: 100vh;
            padding: 50px;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 200000;
        `,t.addEventListener("click",()=>ye(t)),t.tabIndex=0,document.body.prepend(t),document.body.style.overflow="hidden");let r=document.createElement("iframe");r.style.cssText=`
        background-color: #17161A;
        border-radius: 5px;
        width: 100%;
        height: 100%;
    `,t.innerHTML="",t.appendChild(r),r.contentWindow.document.open(),r.contentWindow.document.write(e),r.contentWindow.document.close(),t.addEventListener("keydown",o=>{o.key==="Escape"&&ye(t)}),t.focus()}function ye(e){e.outerHTML="",document.body.style.overflow="visible"}function St(e){return new At(e)}var At=class{constructor(t){this.formData=new FormData,this.hasFile=!1,this.errors=[],t.tagName==="FORM"?this.serializeForm(t):this.collectElementData(t),this.addDirectiveData(t)}collectElementData(t){let r=this.elementHandlers[t.tagName];r&&r.call(this,t)}elementHandlers={SELECT:this.handleSelect,TEXTAREA:this.handleTextArea,INPUT:this.handleInput,BUTTON:this.handleButton};handleSelect(t){t.multiple?Array.from(t.selectedOptions).forEach(r=>{this.formData.append(t.name,r.value)}):this.formData.append(t.name,t.value)}handleTextArea(t){this.formData.append(t.name,t.value)}handleInput(t){let r={checkbox:()=>this.formData.append(t.name,t.checked),radio:()=>{t.checked&&this.formData.append(t.name,t.value)},file:()=>{t.files.length>0&&(Array.from(t.files).forEach(o=>{this.formData.append(t.name,o)}),this.hasFile=!0)},date:()=>{let o=new Date(t.value);isNaN(o.getTime())||this.formData.append(t.name,o.toISOString())},number:()=>{let o=parseFloat(t.value);isNaN(o)||this.formData.append(t.name,o)},default:()=>this.formData.append(t.name,t.value)};(r[t.type]||r.default)()}handleButton(t){t.name&&(t.type==="submit"||t.type==="button")&&this.formData.append(t.name,t.value||t.textContent)}addDirectiveData(t){let r=m(t,"data");r&&this.formData.append(r.value,r.expression);let o=m(t,"add");if(o)try{let n=JSON.parse(o.expression);Object.entries(n).forEach(([i,s])=>{this.formData.append(i,s)})}catch(n){c("Error parsing add directive:",n)}}serializeForm(t){this.formData=new FormData(t),this.hasFile=Array.from(this.formData.values()).some(r=>r instanceof File)}toObject(){let t={};for(let[r,o]of this.formData.entries())t[r]?(Array.isArray(t[r])||(t[r]=[t[r]]),t[r].push(o)):t[r]=o;return t}toJSON(){return JSON.stringify(this.toObject())}get(){return this.formData}hasFiles(){return this.hasFile}getErrors(){return this.errors}};function be(e){return m(e,"swap")?.expression||"innerHTML"}var ve={innerHTML:(e,t)=>{e.innerHTML=t},outerHTML:(e,t)=>{e.outerHTML=t},beforebegin:(e,t)=>{e.insertAdjacentHTML("beforebegin",t)},afterbegin:(e,t)=>{e.insertAdjacentHTML("afterbegin",t)},beforeend:(e,t)=>{e.insertAdjacentHTML("beforeend",t)},afterend:(e,t)=>{e.insertAdjacentHTML("afterend",t)},replace:(e,t)=>{e.replaceWith(..._t(t))},append:(e,t)=>{e.append(..._t(t))},prepend:(e,t)=>{e.prepend(..._t(t))}};function nt(e,t,r){try{v(()=>{(ve[r]||ve.innerHTML)(e,t)})}catch(o){c(`Error applying swap method "${r}":`,o)}}var _t=e=>{let t=document.createElement("div");return t.innerHTML=e,t.childNodes};var V=new WeakMap;function Ee(e){if(V.has(e))return V.get(e);let t=m(e,"target");if(t){let r=t.expression?.trim();if(r){let o=document.querySelector(r);if(o)return V.set(e,o),o;T(`Target element "${r}" not found. Using original element.`)}}return V.set(e,e),e}function we(e){let t=m(e,"target");t?.modifiers.includes("once")&&(e.removeAttribute(t.directive),V.delete(e))}var Nt=new Set,It=!1;async function De(e,t){let o=new DOMParser().parseFromString(t,"text/html"),n=Ee(e),i=be(n),s=o.body.innerHTML,a=n.cloneNode(!0);Tr(n,()=>{nt(n,s,i),wr(a,n),Dr(n),we(n)})}function wr(e,t){let r=I(e),o=I(t);o.forEach(n=>{let i=r.find(s=>s.isEqualNode(n));if(i){let s=g(i);s&&w(n,s)}}),ne(t,e),r.forEach(n=>{o.some(i=>i.isEqualNode(n))||Te(n)})}function Te(e){let t=g(e);t&&t.$refs&&Object.keys(t.$refs).forEach(r=>{t.$refs[r]===e&&delete t.$refs[r]}),X(e),Array.from(e.children).forEach(Te)}function Dr(e){!m(e,"transition")||d(e,"asor:transition",{visible:!0})}function Tr(e,t){Nt.add({el:e,updateFn:t}),Ar()}function Ar(){It||(It=!0,requestAnimationFrame(Sr))}function Sr(){v(()=>{for(let{el:e,updateFn:t}of Nt)t(e);Nt.clear()}),It=!1}var Ct=new Map,Ae=()=>new Mt,Mt=class{async handleRequest(t,r,o){let n=this.buildRequestOptions(r,t);d(document,"asor:before-request",{method:r,url:o,options:n});try{let i=await this.fetchData(r,o,n,t);if(!i)return;await this.handleResponse(i,t)}catch(i){this.handlerError(i,t)}finally{d(document,"asor:after-request",{method:r,url:o,options:n})}}buildRequestOptions(t,r){let o={method:t.toUpperCase(),headers:this.buildHeaders(r)};if(["POST","PUT","PATCH"].includes(o.method)){let n=St(r);o.body=this.prepareRequestBody(r,n)}return o}buildHeaders(t){return{Accept:"text/html, application/xhtml+xml","X-Requested-With":"XMLHttpRequest","X-Current-URL":document.location.href,"X-Asor":"true","Content-Type":this.getContentType(t)}}getContentType(t){let r=St(t);return mt(t)||r.hasFiles()?void 0:m(t,"enctype")?.expression||"application/json"}prepareRequestBody(t,r){return mt(t)||r.hasFiles()?r.get():JSON.stringify(r.toObject())}async fetchData(t,r,o,n){d(document,"asor:before-send",{method:t,url:r,options:o}),d(document,"asor:send",{method:t,url:r,options:o});let i=`${t}:${r}`;if(Ct.has(i))return Ct.get(i);let s=await fetch(r,o);if(!s.ok)return this.handlerError(`HTTP error! status: ${s.status}`,n),!1;let a=await s.text();return Ct.set(i,a),a}async handleResponse(t,r){d(document,"asor:before-render",{response:t});let o=this.getTargetDirective(r);await De(o,t),d(document,"asor:render",{html:t})}getTargetDirective(t){let r=m(t,"target")?.expression;return r?document.querySelector(r):t}handlerError(t,r){c("XHR request failed:",r,t),xe(t.message)}};async function it(e){return m(e,"confirm")?.expression?new Promise(r=>{h(e.__confirm_action)?e.__confirm_action(()=>r(!0),()=>r(!1)):r(!0)}):!0}function Se(e,t){let r;return function(...o){clearTimeout(r),r=setTimeout(()=>e(...o),t)}}function _e(e,t){let r;return function(...o){r||(e.apply(this,o),r=!0,setTimeout(()=>r=!1,t))}}var Lt={enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,shift:16,ctrl:17,alt:18,meta:91},$t=["shift","ctrl","alt","meta"],_r=["get","post","put","patch","delete"],W=new WeakMap,Ie=e=>_r.includes(e.value?.toLowerCase())?e.value.toLowerCase():"get",Ot={form:"submit",select:"change",textarea:"input",button:"click",input:{button:"click",submit:"click",reset:"click",checkbox:"change",radio:"change",file:"change",date:"change",time:"change","datetime-local":"change"},default:"click"};function Ce(e){let t=e.tagName.toLowerCase(),r=(e.type||"").toLowerCase();return t==="input"?Ot.input[r]||"input":Ot[t]||(e.isContentEditable?"input":e.getAttribute("tabindex")!==null?"focus":Ot.default)}var st=(e,t,r={})=>{let{preventDefault:o,stopPropagation:n,once:i,delay:s,throttleTime:a,passive:f,keyModifiers:l,self:p}={preventDefault:!1,stopPropagation:!1,once:!1,delay:0,throttleTime:0,passive:!1,keyModifiers:[],self:!1,...r},D=JSON.stringify({preventDefault:o,stopPropagation:n,once:i,delay:s,throttleTime:a,passive:f,keyModifiers:l,self:p});W.has(e)||W.set(e,new Map);let C=W.get(e);if(!C.has(D)){let Fe=async A=>{if(A.type==="intersect")return Ne(()=>t(A),s,a);p&&A.target!==e||Cr(A)&&!Mr(A,l)||(o&&!f&&h(A.preventDefault)&&A.preventDefault(),n&&h(A.stopPropagation)&&A.stopPropagation(),Ne(()=>Ir(e,A,t),s,a),i&&Nr(e,D))};C.set(D,Fe)}return C.get(D)},Ne=(e,t,r)=>t>0?Se(e,t)():r>0?_e(e,r)():e(),Nr=(e,t)=>{let r=W.get(e);r.delete(t),r.size===0&&W.delete(e)},Ir=async(e,t,r)=>{try{if(!await it(e))return;(h(r)?await r.call(e,t):!0)!==!1&&e.__xhr_handler&&!e.__xhr_request_in_progress&&await e.__xhr_handler.call(e,t)}catch(o){c("Error in event handler:",o,e)}},Cr=e=>e.type?.startsWith("key"),Mr=(e,t)=>t.every(r=>$t.includes(r)?e[`${r}Key`]:e.keyCode===Lt[r]),Or=(e,t,r={})=>{let o=new IntersectionObserver(n=>{n.forEach(i=>{if(i.isIntersecting)try{t(i,e),r.once&&o.unobserve(e),r.disconnect&&o.disconnect()}catch(s){c("Error in IntersectionObserver callback:",s)}})},r);return o.observe(e),()=>o.disconnect()},Me=(e,t,r,o={})=>y(document,t,n=>{e.contains(n.target)||r(n)},o);var at=(e,t,r)=>{let{rootMargin:o="0px",threshold:n=.1,once:i}=r;return Or(e,(a,f)=>{let l={type:"intersect",detail:{entry:a,element:f},target:f};d(f,"intersect",l.detail)&&t.call(f,l)},{rootMargin:o,threshold:n,once:i,disconnect:i})};u("xhr",({el:e,directive:t,manager:r})=>{let o=t.expression,n=Ie(t),i=Ce(e),s=async()=>{if(!e.__xhr_request_in_progress){e.__xhr_request_in_progress=!0;try{await Ae().handleRequest(e,n,o)}catch(f){c("XHR request failed:",f)}finally{e.__xhr_request_in_progress=!1}}},a=()=>{};if(r.hasDirective("on"))e.__xhr_handler=s;else{let f=st(e,s,{preventDefault:!0,stopPropagation:!0});a=y(e,i,f)}return()=>{a(),delete e.__xhr_handler,delete e.__xhr_request_in_progress}});function Oe(e,t){if(!(e instanceof Map))return t;for(let[,r]of e){let o=b(r)?r.value:r;if(S(o)){let n=ct(o);if(n!==null)return n}}return t}function ct(e){let t=/^(\d+)(ms|s)$/;if(S(e)&&t.test(e)){let[,r,o]=e.match(t);return o==="ms"?Number(r):Number(r)*1e3}return null}u("on",({el:e,directive:t})=>{let{modifiers:r,expression:o,value:n}=t,i=n?n.split(",").map(a=>a.trim()):[];if(i.length===0){c("No event specified for a-on directive in element: ",e);return}let s={preventDefault:r?.has("prevent")||!1,stopPropagation:r?.has("stop")||!1,once:r?.has("once")||!1,capture:r?.has("capture")||!1,passive:r?.has("passive")||!1,self:r?.has("self")||!1,window:r?.has("window")||!1,document:r?.has("document")||!1,outside:r?.has("outside")||!1,rootMargin:r?.get("rootMargin")?.value,threshold:r?.get("threshold")?.value,delay:ct(r?.get("debounce")?.value||"0"),throttle:ct(r?.get("throttle")?.value||"0"),keyModifiers:Array.from(r?.keys()||[]).filter(a=>a in Lt||$t.includes(a))};try{let f=st(e,async p=>await x(e,o,{$event:p,$el:e}),s),l=i.map(p=>p==="intersect"?at(e,f,s):Lr(e,p,f,s));return()=>l.forEach(p=>p())}catch(a){c(`Error evaluating expression in a-on directive: ${a.message}`,e)}});function Lr(e,t,r,o){return o.window?y(window,t,r,o):o.document?y(document,t,r,o):o.outside&&t==="click"?Me(e,t,r,o):y(e,t,r,o)}async function $r(e,t,r,o,n,i,s){let a=document.createElement("template");a.innerHTML=e.trim();let f=a.content.firstElementChild||a.content.firstChild;if(!f)return c("Invalid template in a-for directive",s),null;let l={...n,[i.item]:t,[i.key||"key"]:r,[i.index||"index"]:r,length:o,parent:n};w(f,l),_(f);let p=m(f,"if");if(p&&!await x(f,p.expression,l))return null;let D=m(f,"show");return D&&(f.style.display=await x(f,D.expression,l)?"":"none"),I(f).forEach(C=>{oe(C)&&J(C)}),f}async function Le(e,t,r,o,n){if(t==null){T("Items is null or undefined in appendItems");return}let i=Array.isArray(t),s=i?t:b(t)?Object.entries(t):[];for(let a=0;a<s.length;a++){let[f,l]=i?[a,s[a]]:s[a],p=await $r(o,l,f,s.length,r,n,e);p&&e.appendChild(p)}}u("for",({el:e,directive:t})=>{let r=me(t.expression);if(!r){c("Invalid expression for a-for directive",e);return}let o=e.innerHTML;e.innerHTML="";let n=()=>{v(async()=>{let s=g(e.parentElement);if(!s){T("No parent data found for a-for directive",e);return}let a=await x(e.parentElement,r.items,s);if(O(a)){T(`${r.items} is not defined`,e);return}e.innerHTML="",await Le(e,a,s,o,r)})};n();let i=R((s,a)=>{s===e.parentElement&&a.startsWith(E)&&n()});return()=>i()});u("if",({el:e,directive:t})=>{let{expression:r}=t,o=document.createComment(`if: ${r}`),n=!1,i=v(()=>{let s=x(e,r);s&&!n&&e.parentNode?(e.parentNode.insertBefore(o,e.nextSibling),n=!0):!s&&n&&e.parentNode&&(e.parentNode.replaceChild(o,e),n=!1)});return e.parentNode&&e.parentNode.insertBefore(o,e.nextSibling),()=>{i(),o.parentNode&&o.remove(),n&&e.parentNode&&e.remove()}});u("show",({el:e,directive:t})=>{let{expression:r,modifiers:o}=t,n=async()=>{try{let s=await x(e,r);O(s)||Rr(e,s,o.has("important"))}catch(s){console.error("Error updating visibility for element:",e,s)}};return n(),R((s,a)=>{s.contains(e)&&a.startsWith(E)&&n()})});function Rr(e,t,r){m(e,"transition")?d(e,"asor:transition",{visible:t}):v(()=>{e.style.display=t?"":"none",r&&e.style.setProperty("display",e.style.display,"important")})}var N=class{constructor(t={}){this.options={...N.DEFAULT_OPTIONS,...t},this.bar=null,this.visible=!1,this.timeout=null,this.value=0,this.trickleInterval=null}show(){this.visible||(this.visible=!0,this.value=0,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.createBar(),this.trickle()},this.options.delay))}hide(){!this.visible||(clearTimeout(this.timeout),clearInterval(this.trickleInterval),this.visible=!1,this.setValue(100),this.timeout=setTimeout(()=>{this.removeBar(),this.value=0},this.options.duration))}setValue(t){this.value=Math.min(100,Math.max(0,t)),this.bar&&(this.bar.style.width=`${this.value}%`,this.updateARIA())}trickle(){clearInterval(this.trickleInterval),this.trickleInterval=setInterval(()=>{let t=100-this.value,r=.02*Math.pow(1-Math.sqrt(t),2);this.setValue(this.value+r)},100)}createBar(){this.bar||(this.bar=document.createElement("div"),this.bar.className=this.options.className,this.bar.style.cssText=`
            position: fixed;
            top: 0;
            left: 0;
            width: 0;
            height: ${this.options.height};
            background-color: ${this.options.color};
            z-index: ${this.options.zIndex};
            transition: width ${this.options.duration}ms ease-out;
            box-shadow: 0 0 10px ${this.options.color}, 0 0 5px ${this.options.color};
            pointer-events: none;
        `,this.setAccessibility(),document.body.appendChild(this.bar))}removeBar(){this.bar&&this.bar.parentNode&&(this.bar.parentNode.removeChild(this.bar),this.bar=null)}setAccessibility(){!this.bar||(this.bar.setAttribute("role","progressbar"),this.bar.setAttribute("aria-valuemin","0"),this.bar.setAttribute("aria-valuemax","100"),this.updateARIA())}updateARIA(){!this.bar||(this.bar.setAttribute("aria-valuenow",Math.round(this.value)),this.bar.setAttribute("aria-label",`Progress: ${Math.round(this.value)}%`))}static injectStyles(){let t=document.createElement("style");t.textContent=`
            @keyframes asor-progress-bar-pulse {
                0% { box-shadow: 0 0 10px ${N.DEFAULT_OPTIONS.color}, 0 0 5px ${N.DEFAULT_OPTIONS.color}; }
                50% { box-shadow: 0 0 20px ${N.DEFAULT_OPTIONS.color}, 0 0 10px ${N.DEFAULT_OPTIONS.color}; }
                100% { box-shadow: 0 0 10px ${N.DEFAULT_OPTIONS.color}, 0 0 5px ${N.DEFAULT_OPTIONS.color}; }
            }
            .${N.DEFAULT_OPTIONS.className} {
                animation: asor-progress-bar-pulse 1.5s infinite ease-in-out;
            }
        `;let r=Bt("csp-nonce");r&&(t.nonce=r),document.head.appendChild(t)}},P=N;qt(P,"DEFAULT_OPTIONS",{color:"#29d",height:"3px",duration:300,delay:300,zIndex:14062024,className:"asor-progress-bar"});P.injectStyles();var $e=10,Re=50,ft=class{constructor(){this.progressBar=new P({delay:250}),this.cache=new Map,this.scrollPositions=new Map,this.currentRequest=null,this.executedScripts=new Set,window.addEventListener("popstate",this.handlePopState.bind(this))}handleNavigate=async t=>{if(this.shouldInterceptClick(t))return;t.preventDefault();let r=t.currentTarget.href||t.currentTarget.getAttribute("href");if(!r){c("No URL found for navigation.");return}await this.navigate(r)};shouldInterceptClick=t=>t.which>1||t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;handlePopState=async t=>{let r=t.state?.asor;if(r?._html){let o=this.fromSessionStorage(r._html);await this.renderView(o),this.rehydrateBindings()}else await this.navigate(window.location.href,{pushState:!1})};rehydrateBindings(){document.querySelectorAll("*").forEach(t=>{let r=Array.from(t.attributes).filter(o=>o.name.startsWith(E));r.length>0&&r.forEach(o=>{try{let n=JSON.parse(sessionStorage.getItem(o.name)||"{}");w(t,n),_(t)}catch(n){c("Error rehydrating bindings",n)}})})}async navigate(t,r={pushState:!0}){try{this.clearExecutedScripts(),this.progressBar.show(),this.saveScrollPosition(),d(document,"asor:navigating",{url:t});let o=await this.loadView(t);if(!o)return;let n=new URL(t,document.baseURI);await(r.pushState?this.pushState(n,o.html):this.replaceState(n,o.html)),await this.renderView(o.html),this.restoreScrollPosition(t),this.animateTransition(),d(document,"asor:navigated",{url:n.href})}catch(o){c("Navigation error:",o)}finally{this.progressBar.hide()}}async loadView(t){let r=t.toString();if(this.cache.has(r))return this.cache.get(r);this.currentRequest&&this.currentRequest.abort();let o=new AbortController;this.currentRequest=o;try{let n=new URL(t,window.location.origin).href,i=await fetch(n,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},signal:o.signal});i.ok||c(`Navigation to ${t} failed with status ${i.status}`);let a={html:await i.text()};return this.cache.set(r,a),this.trimCache(),a}catch(n){throw n.name==="AbortError"?T(`Request to ${t} aborted`):c(`Error during navigation to ${t}:`,n),n}finally{this.currentRequest===o&&(this.currentRequest=null)}}trimCache(){this.cache.size>Re&&Array.from(this.cache.keys()).slice(0,this.cache.size-Re).forEach(r=>this.cache.delete(r))}saveScrollPosition(){this.scrollPositions.set(window.location.href,{x:window.scrollX,y:window.scrollY})}restoreScrollPosition(t){requestAnimationFrame(()=>{let r=this.scrollPositions.get(t)||{x:0,y:0};window.scrollTo(r.x,r.y)})}animateTransition(){document.body.style.opacity="0",requestAnimationFrame(()=>{document.body.style.transition="opacity 0.3s",document.body.style.opacity="1",setTimeout(()=>{document.body.style.transition=""},300)})}async pushState(t,r){await this.updateState("pushState",t,r)}async replaceState(t,r){await this.updateState("replaceState",t,r)}async updateState(t,r,o){this.trimHistory();let n=Date.now();await this.storeInSession(n,o);let i={asor:{_html:n}};try{history[t](i,document.title,r)}catch(s){s instanceof DOMException&&s.name==="SecurityError"&&c(`Cannot use asor:navigate with a link to a different root domain: ${r}`)}}trimHistory(){let t=history.length;t>$e&&history.go($e-t)}fromSessionStorage(t){try{return JSON.parse(sessionStorage.getItem(`asor:${t}`))}catch(r){return c("Error retrieving from session storage:",r),null}}async storeInSession(t,r){try{sessionStorage.setItem(`asor:${t}`,JSON.stringify(r))}catch(o){o.name==="QuotaExceededError"?(this.clearOldestSessionItem(),await this.storeInSession(t,r)):c("Error storing in session storage:",o)}}clearOldestSessionItem(){let t=Object.keys(sessionStorage).filter(r=>r.startsWith("asor:")).sort();t.length>0&&sessionStorage.removeItem(t[0])}async renderView(t){let o=new DOMParser().parseFromString(t,"text/html");document.title=o.title,await this.updateHead(o.head),await this.updateBody(o.body),this.executeScripts(document.body),this.executeScripts(document.head),window.Asor&&h(window.Asor.start)&&window.Asor.start(!0)}async updateHead(t){let r=document.head;Array.from(r.children).forEach(o=>{o.hasAttribute("data-persist")||o.remove()}),Array.from(t.children).forEach(o=>{o.hasAttribute("data-persist")||r.appendChild(o.cloneNode(!0))})}async updateBody(t){document.body.innerHTML=t.innerHTML}executeScripts(t){t.querySelectorAll("script").forEach(r=>{let o=r.src,n=r.textContent;if(this.executedScripts.has(o)||this.executedScripts.has(n))return;let i=document.createElement("script");Array.from(r.attributes).forEach(s=>i.setAttribute(s.name,s.value)),o?(i.src=o,this.executedScripts.add(o)):(i.textContent=`(function() { ${n} })();`,this.executedScripts.add(n)),r.parentNode.replaceChild(i,r)})}clearExecutedScripts(){this.executedScripts.clear()}async preloadView(t){if(!this.cache.has(t))try{let r=new URL(t,window.location.origin).href,o=await fetch(r,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},signal:AbortSignal.timeout(1e4)});o.ok||c(`Preload of ${t} failed with status ${o.status}`);let n=await o.text();this.cache.set(t,{html:n}),this.trimCache()}catch(r){c("Preload error:",r)}}};var j;u("navigate",({el:e,directive:t})=>{if(j||(j=new ft),e.hasNavigateListener)return;e.hasNavigateListener=!0;let r=!1;y(e,"click",async n=>{if(!r){r=!0,n.type==="click"&&n.preventDefault();try{await it(e)&&await j.handleNavigate(n)}catch(i){c("Navigation error:",i)}finally{r=!1}}}),t.hasModifier("lazy")?Fr(e,t):t.hasModifier("hover")&&Pr(e)});function Fr(e,t){return at(e,()=>{let o=e.getAttribute("href");o&&j.preloadView(o)},{rootMargin:t.getModifierValue("margin")||"90px",once:t.hasModifier("once")})}function Pr(e){y(e,"mouseenter",()=>{let r=e.getAttribute("href");r&&j.preloadView(r)})}u("transition",({el:e,directive:t})=>{let r=Ur(t),o=!1,n=null,i=f=>{if(o||f===n)return;o=!0,n=f;let l=f?"enter":"leave",p=f?r.enterDuration:r.leaveDuration;v(()=>{r.useClasses?Hr(e,l,p):qr(e,f,r)}),setTimeout(()=>{o=!1,f||(e.style.display="none")},p)},a=y(e,"asor:transition",f=>{let l=f.detail.visible;l!==n&&(l&&(e.style.display=""),i(l))});return n=window.getComputedStyle(e).display!=="none",n||(e.style.display="none"),a});function Hr(e,t,r){v(()=>{let o=m(e,`transition:${t}`)?.expression,n=m(e,`transition:${t}-start`)?.expression,i=m(e,`transition:${t}-end`)?.expression;o&&e.classList.add(o),n&&(e.classList.add(n),requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.classList.remove(n),i&&e.classList.add(i)})})),setTimeout(()=>{o&&e.classList.remove(o),i&&e.classList.remove(i)},r)})}function qr(e,t,r){v(()=>{e.style.transition="none",e.offsetWidth,e.style.opacity=t?r.initialOpacity:"1",r.scale&&(e.style.transform=`scale(${t?r.initialScale:"1"})`),e.offsetWidth,e.style.transition=`all ${t?r.enterDuration:r.leaveDuration}ms ${r.easing}`,e.style.opacity=t?"1":r.initialOpacity,r.scale&&(e.style.transform=`scale(${t?"1":r.initialScale})`),r.origin!=="center"&&(e.style.transformOrigin=r.origin)})}function Ur(e){let t={enterDuration:300,leaveDuration:300,delay:0,easing:"ease",opacity:!0,scale:!1,initialOpacity:"0",initialScale:"0.95",useClasses:!1,origin:"center"},r=new Map([["duration","enterDuration"],["enter","enterDuration"],["leave","leaveDuration"],["delay","delay"]]);return e.modifiers.forEach((o,n)=>{r.has(n)?(t[r.get(n)]=Oe(new Map([[n,o]]),t[r.get(n)]),n==="duration"&&(t.leaveDuration=t.enterDuration)):["ease","ease-in","ease-out","ease-in-out","linear"].includes(n)?t.easing=n:n==="opacity"?(t.opacity=!0,t.scale=!1):n==="scale"?(t.scale=!0,t.opacity=o!=="false",o&&o!=="true"&&(t.initialScale=parseFloat(o)/100)):n==="origin"&&(t.origin=o||"center")}),(m(e.el,"transition:enter")||m(e.el,"transition:leave"))&&(t.useClasses=!0),t}function M(e,t,r,o=null){v(()=>{if(r=t.hasModifier("remove")?!r:r,t.hasModifier("class")){let n=t.expression.split(" ").filter(String);r?e.classList.add(...n):e.classList.remove(...n)}else if(t.hasModifier("attr"))r?e.setAttribute(t.expression,!0):e.removeAttribute(t.expression);else{let n=o??Kt(e,"display"),i=["inline","block","table","flex","grid","inline-flex"].find(s=>t.hasModifier(s))||"inline-block";i=t.hasModifier("remove")&&!r?n:i,e.style.display=r?i:"none"}})}u("loading",({el:e,directive:t})=>{let r={shortest:50,shorter:100,short:150,default:200,long:300,longer:500,longest:1e3},o=t.getAllModifiers().reduce((D,C)=>r[C.name]||D,r.default),n,i=!1,a=(D=>t.hasModifier("delay")&&!t.hasModifier("none")?()=>{n=setTimeout(()=>{D()},o)}:D)(()=>{i||(i=!0,M(e,t,!0))}),f=()=>{clearTimeout(n),i&&(i=!1,M(e,t,!1))},l=y(document,"asor:before-send",a),p=y(document,"asor:after-request",f);return()=>{l(),p(),clearTimeout(n)}});var Rt=new Set,Ft=new Set;function Pt(){(navigator.onLine?Ft:Rt).forEach(r=>r())}window.addEventListener("online",Pt);window.addEventListener("offline",Pt);typeof navigator.onLine<"u"&&Pt();u("offline",({el:e,directive:t})=>{let r=()=>M(e,t,!0),o=()=>M(e,t,!1);return Rt.add(r),Ft.add(o),typeof navigator.onLine<"u"&&M(e,t,!navigator.onLine),()=>{Rt.delete(r),Ft.delete(o)}});var kr=5e3;u("stream",({el:e,directive:t})=>{let r=t.expression,o=m(e,"swap")?.expression||"innerHTML",n=null,i=()=>{n=new EventSource(r),e._stream=n,n.onopen=()=>d(e,"stream:open"),n.onmessage=a=>Vr(e,a,o),n.onerror=a=>Wr(e,a,i)},s=()=>{n&&(n.close(),n=null)};return i(),Z(e,()=>s)});function Vr(e,t,r){nt(e,t.data,r),d(e,"stream:message",{data:t.data})}function Wr(e,t,r){d(e,"stream:error",{error:t}),r(),setTimeout(r,kr)}var jr={on:kt,stop:wt,start:ue,evaluate:x,directive:u,onDataChange:et,dispatchSelf:Wt,dispatchGlobal:Vt},Ht=jr;window.Asor=Ht;queueMicrotask(()=>Ht.start());})();
