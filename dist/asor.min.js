(()=>{var b=t=>t!==null&&typeof t=="object"&&!Array.isArray(t),h=t=>typeof t=="function",K=t=>Array.isArray(t),_=t=>typeof t=="string";var O=t=>t===void 0,X=t=>t instanceof Element;var lt=(t,e)=>JSON.stringify(t)===JSON.stringify(e);function A(t,e={},...r){kt("Warning",t,e,...r)}function c(t,e={}){let r=typeof t=="string"?t:t.message||"Unknown error",o={message:r,...e};setTimeout(()=>kt("Error",r,o),0)}function mt(t,e={},...r){let{el:o,expression:n,message:i="",defaultValue:s=null,rethrow:a=!1,onError:u}=e;try{return t(...r)}catch(d){let p=`${i}
${d.message}`;if(c(p,{el:o,expression:n}),u&&h(u)&&u(d,{el:o,expression:n,message:i}),a)throw d;return s}}function kt(t,e,r={},...o){let{el:n,expression:i,component:s}=r,a=new Date().toISOString(),u={message:e,el:n,expression:i,component:s,timestamp:a,additionalInfo:o},d=t.toLowerCase()==="error"?"#FF0000":"#FFA500";console.groupCollapsed(`%c[Asor ${t}]: ${e}`,`color: ${d}; font-weight: bold;`),console.log(u),console.groupCollapsed("Stack Trace"),console.trace(),console.groupEnd()}var pt=new Map,y=(t,e,r,o={})=>{let n=pt.get(e);n||(n=new Set,pt.set(e,n)),n.add(r);let i=new AbortController;return t.addEventListener(e,r,{...o,signal:i.signal}),()=>{i.abort(),n.delete(r),n.size===0&&pt.delete(e)}},l=(t,e,r,o={})=>{let n=new CustomEvent(e,{bubbles:!0,cancelable:!0,...o,detail:r});return n.__asor={name:e,detail:r,receivedBy:[]},t.dispatchEvent(n)},jt=(t,e)=>y(window,t,r=>r.__asor&&e(r)),Wt=(t,e)=>l(window,t,e),Bt=(t,e,r)=>l(t,e,r,{bubbles:!1});var zt=(t,e)=>{for(;t&&t!==document.body;){if(e(t))return t;t=t.parentElement}return null},Kt=t=>document.querySelector(`meta[name='${t}']`)?.getAttribute("content")||"";var Xt=t=>zt(t,e=>e.hasAttribute("a-def"))||document.body,Jt=t=>zt(t,e=>e.dataset&&Object.keys(e.dataset).length>0||e.hasAttribute("a-def"))||document.body;var ht=t=>t.tagName==="FORM";var Yt=(t,e)=>window.getComputedStyle(t).getPropertyValue(e);var Gt=(t=36)=>Math.random().toString(t).substring(2,10);function C(t=document.body,e=["a-","@",":"]){let r=[],o=document.createNodeIterator(t,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>Array.from(i.attributes).some(s=>e.some(a=>s.name.startsWith(a)))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}),n;for(;n=o.nextNode();)r.push(n);return r}var $=new WeakMap,E="data-a-",Qt=t=>Array.from(t.attributes).find(e=>e.name.startsWith(E))?.name||null,w=(t,e)=>X(t)?b(e)?(lt($.get(t),e)||($.set(t,e),t.__asor_def=e,te(t)),e):(c(`${e} must be a valid object`,t),null):(c("The element is not a valid HTML element",t),null);function g(t){for(;t;){if(t.__asor_def)return t.__asor_def;t=t.parentElement}return{}}var J=t=>{$.delete(t);let e=Qt(t);e&&t.removeAttribute(e),delete t.__asor_def};function T(t){try{if(!$.get(t))return;te(t)}catch(e){c("Error updating data for element",t,e)}}function Zt(t){try{let e=$.get(t),r=t.__asor_def;ke(e,r)&&$.set(t,{...r})}catch(e){c("Error updating data for element",t,e)}}var ke=(t,e)=>!lt(t,e);function te(t){try{(()=>{let r=Gt(),o=Qt(t);o&&t.removeAttribute(o),t.setAttribute(`${E}${r}`,"")})()}catch(e){c("Error serializing data for element",t,e)}}var ee=new WeakMap,oe=new Map,gt=new Map;function je(t){let e=t.join("|");return gt.has(e)||gt.set(e,new RegExp(`^(?:${e})([^\\s.:]+)(?:\\.[^\\s.:]+)*(?::[^\\s]+)?\\s*`)),gt.get(e)}var We=t=>{if(!t)throw new Error("Directive name is required");return t.startsWith(":")?`a-bind:${t.slice(1)}`:t.startsWith("@")?`a-on:${t.slice(1)}`:t.startsWith("a-")?t:`a-${t}`},f=(t,e)=>oe.set(t,e),ne=()=>C().forEach(G);function G(t){if(!t)return c(`Undefined element: ${t}`);let e=Y(t);e.directives.sort((r,o)=>re.get(r.name)-re.get(o.name)).forEach(r=>{let o=oe.get(r.name);o&&o({el:t,directive:r,manager:e})})}var ie=t=>Array.from(t.attributes).some(e=>e.name.startsWith(":")||e.name.startsWith("@")||e.name.startsWith("a-")),Y=t=>{let e=ee.get(t);if(!e){let r=ze(t);e={el:t,directives:r,hasDirective:o=>r.some(n=>n.name===o),getDirective:o=>r.find(n=>n.name===o),delDirective:o=>e.directives=e.directives.filter(n=>n.name!==o)},ee.set(t,e)}return e},Be=["ref","def","bind","init","confirm","xhr","on","effect","show","navigate","transition","for","if","loading","offline","stream"],re=new Map(Be.map((t,e)=>[t,e])),m=(t,e)=>{let r=Y(t).getDirective(e);return r?{...r,name:e}:null},ze=t=>{if(!t?.attributes)return c("Invalid element in extractDirectives"),[];let e=je(["a-","@",":"]);return Array.from(t.attributes).filter(r=>e.test(r.name)).map(({name:r,value:o})=>Ke(t,r,o))},Ke=(t,e,r)=>{let o=We(e),{directiveName:n,directiveValue:i}=Xe(o),s=Je(e);return{el:t,name:n,fullName:o,expression:r,value:i,modifiers:s,hasModifier:a=>s.has(a),getModifierValue:a=>s.get(a),getAllModifiers:()=>Array.from(s,([a,u])=>({name:a,value:u})),hasModifiers:()=>s.size>0,firstModifier:()=>{let[a,u]=s.entries().next().value||[];return a?{name:a,value:u}:null}}},Xe=t=>{let e=/^a-(?:(on):)?([^:.]+)(?::([^.]+))?/,[,r,o,n]=t.match(e)||[];return{directiveName:r||o,directiveValue:r?o:n}},Je=t=>{let e=t.match(/\.[^.\]]+(?=[^\]]*$)/g)||[];return new Map(e.map(r=>{let[o,n]=r.slice(1).split("-");return[o,n===void 0?!0:n]}))};async function se(t,e){let r=C(t),o=C(e);r.forEach(n=>{let i=o.find(s=>s.isEqualNode(n));if(!i||!Ye(n,i))G(n);else{let s=g(i);s&&w(n,s)}})}function Ye(t,e){let r=Y(t),o=Y(e);return r.directives.length!==o.directives.length?!1:r.directives.every((n,i)=>{let s=o.directives[i];return n.name===s.name&&n.expression===s.expression})}var ae={CHILD_LIST:"childList",ATTRIBUTES:"attributes"},H={elementAdded:new Set,elementRemoved:new Set,attributeChanged:new Set},Z=null,q=!1,tt=!1,yt=class{constructor(){this.addedNodes=new Set,this.removedNodes=new Set,this.changedAttributes=new Map}add(e){if(e.type===ae.CHILD_LIST)e.addedNodes.forEach(r=>r.nodeType===Node.ELEMENT_NODE&&this.addedNodes.add(r)),e.removedNodes.forEach(r=>r.nodeType===Node.ELEMENT_NODE&&this.removedNodes.add(r));else if(e.type===ae.ATTRIBUTES&&e.attributeName.startsWith(E)){let r=e.target.getAttribute(e.attributeName);e.oldValue!==r&&this.changedAttributes.set(e.target,{attributeName:e.attributeName,oldValue:e.oldValue,newValue:r})}}process(e){let r=(n,i)=>{for(let s of n){if(e.timeRemaining()<=0&&!e.didTimeout)return!1;i(s),n.delete(s)}return!0},o=()=>{for(let[n,{attributeName:i,oldValue:s,newValue:a}]of this.changedAttributes){if(e.timeRemaining()<=0&&!e.didTimeout)return!1;H.attributeChanged.forEach(u=>Q(u,n,i,s,a)),Q(()=>Zt(n)),this.changedAttributes.delete(n)}return!0};return r(this.addedNodes,n=>H.elementAdded.forEach(i=>Q(i,n)))&&r(this.removedNodes,n=>H.elementRemoved.forEach(i=>Q(i,n)))&&o()}isEmpty(){return this.addedNodes.size===0&&this.removedNodes.size===0&&this.changedAttributes.size===0}},L=new yt,Ge=()=>{if(tt)return;tt=!0;let t=e=>{L.process(e)?tt=!1:requestIdleCallback(t)};requestIdleCallback(t)},Qe=t=>{t.forEach(e=>L.add(e)),L.isEmpty()||Ge()},Q=(t,...e)=>{try{t(...e)}catch(r){c("Error in mutation observer callback:",t.toString(),r)}},xt=()=>{q||!document||(Z||(Z=new MutationObserver(Qe)),Z.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),q=!0)},vt=()=>{q&&(Z.disconnect(),q=!1)},bt=t=>e=>{if(h(e))return H[t].add(e),()=>H[t].delete(e);c(`Invalid callback provided to on${t.charAt(0).toUpperCase()+t.slice(1)}`)},ho=bt("elementAdded"),et=bt("elementRemoved"),R=bt("attributeChanged"),v=t=>{let e=q;e&&vt();try{t()}finally{e&&xt()}},ce=()=>{L.addedNodes.clear(),L.removedNodes.clear(),L.changedAttributes.clear(),tt=!1};var F=new WeakMap,Et=new Set,rt=!1;function P(t,e){return F.has(t)||F.set(t,new Set),F.get(t).add(e),()=>{let r=F.get(t);r&&(r.delete(e),r.size===0&&F.delete(t))}}function ot(t){Et.add(t),Ze()}function Ze(){rt||(rt=!0,queueMicrotask(()=>tr()),rt=!1)}function tr(){Et.forEach(t=>{T(t);let e=F.get(t);e&&e.forEach(r=>r())}),Et.clear(),rt=!1}var ue="asor_persist_";function fe(t,e){let r=t.uniqueId||ue+t,o=localStorage.getItem(r);if(o===null)return e;try{return JSON.parse(o)}catch(n){return A(`Error parsing stored value for key ${t}:`,n),e}}function wt(t,e){let r=t.uniqueId||ue+t;try{localStorage.setItem(r,JSON.stringify(e))}catch(o){c(`Error storing value for key ${t}:`,o)}}var U=new WeakMap;function Dt(t,e){if((!t||!b(t))&&(t={}),U.has(t))return U.get(t);let r=nr(t,e),o=new Proxy(r,er(e));return U.set(t,o),o}function er(t){return{get(e,r,o){let n=Reflect.get(e,r,o);return n&&n.__isPersist?n.value:h(n)&&!r.startsWith("__")?rr(n,t,o):n},set(e,r,o,n){if(or(e,r,o,t))return!0;let i=e[r];return Reflect.set(e,r,o,n),i!==o&&ot(t),!0}}}function rr(t,e,r){return function(...o){let n=t.apply(r,o);return ot(e),n}}function or(t,e,r,o){if(t[e]&&t[e].__isPersist){let n=t[e].value;return t[e].value=r,wt(e,r),n!==r&&ot(o),!0}return!1}function nr(t,e){let r={};return ir(t,r),sr(t,r,e),r}function ir(t,e){Object.keys(t).forEach(r=>{let o=Object.getOwnPropertyDescriptor(t,r);o&&typeof o.get=="function"&&Object.defineProperty(e,r,{get:o.get.bind(e),enumerable:!0,configurable:!0})})}function sr(t,e,r){Object.entries(t).forEach(([o,n])=>{n&&n.__isPersist?e[o]=ar(o,n):b(n)?e[o]=Dt(n,r):h(n)?e[o]=n:e[o]||(e[o]=n)})}function ar(t,e){let r=fe(t,e.initialValue);return r==null&&(r=e.initialValue),wt(t,r),{__isPersist:!0,value:r}}function de(t){let e=g(t);e&&U.has(e)&&U.delete(e)}var nt=!1;function le(t=!1){if(nt&&!t){A("Asor is already initialized. Skipping re-initialization.");return}At();let e=()=>{ce(),l(document,"asor:init"),l(document,"asor:initializing"),requestAnimationFrame(()=>{xt(),ne(),nt=!0,l(document,"asor:initialized")})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e()}function At(t=null){nt&&(vt(),cr(),window.asor&&delete window.asor,t&&h(t)&&t(),l(document,"asor:stopped"),nt=!1)}function cr(){document.querySelectorAll("*").forEach(t=>{Array.from(t.attributes).filter(r=>r.name.startsWith(E)).forEach(r=>t.removeAttribute(r.name)),de(t)})}var M={};function ur(t={}){return M=new Proxy(t,{get(e,r){return typeof e[r]=="object"&&e[r]!==null?new Proxy(e[r],this):e[r]},set(e,r,o){return e[r]=o,me(),!0}}),M}function me(){document.querySelectorAll("[a-def]").forEach(t=>{try{t&&t.__asor_def&&(t.__asor_def.$store={...M},T(t))}catch(e){c("Error updating element after store change:",e,t)}})}var V=()=>M;function fr(t,e){typeof e=="object"&&e!==null?M[t]={...M[t],...e}:M[t]=e,me()}var pe=(t,e)=>e===void 0?V()[t]:fr(t,e);ur();var Tt={parseInt,parseFloat,isNaN,isFinite,encodeURIComponent,decodeURIComponent,encodeURI,decodeURI};function it(t,e={}){let r=Xt(t),o=g(t)||g(r)||{},n=r._asor_refs||{},i={$el:t,$event:e.$event||{},$refs:n,$root:{...r,dataset:r?{...r.dataset}:{}},$dispatch:(s,a)=>l(t,s,a),$persist:s=>({__isPersist:!0,initialValue:s}),$store:V()};return{...i,$data:new Proxy(o,{get(s,a){if(a in s)return s[a];if(a in i)return i[a];if(a in e)return e[a];if(a in Tt)return Tt[a]}}),...Tt,...e}}var k=new Map,dr=500,lr=(t,e)=>({el:t,expression:e,rethrow:!1,defaultValue:null,message:`Error evaluating expression: "${e}"`}),mr=t=>`
    with (__context) {
        with ($data) {
            return (${t});
        }
    }
`,pr=t=>`
    try {
        ${t}
    } catch (e) {
        if (e instanceof ReferenceError) return undefined;
        throw e;
    }
`,hr=t=>{let e=mr(t),r=pr(e);return new Function("__context",r)},gr=(t,e)=>{let r=Object.keys(e).sort().join(",");return`${t}::${r}`},yr=(t,e)=>{if(k.size>=dr){let r=k.keys().next().value;k.delete(r)}k.set(t,e)};function St(t,e,r){let o=lr(t,e);if(h(e))return mt(e,o,r);if(!_(e))return c(`Invalid expression type: ${typeof e}. Expected string or function.`,t,e),null;let n=it(t,r),i=gr(e,n),s=k.get(i);return s||(s=hr(e),yr(i,s)),mt(()=>s(n),o)}var x=(t,e,r={})=>St(t,e,r);var _t=new Map;function he(t,e){if(typeof e!="function"){c(`Component "${t}" must be a function.`);return}_t.set(t,e)}function xr(t){return _t.get(t)}function ge(t){return _t.has(t)}var ye=(t,e)=>{let r=xr(t);try{let o=it(e,{});return r(o)}catch(o){return c(`Error executing component: ${o.message}`,{el:e,expression:t}),null}};f("ref",({el:t,directive:e})=>{let r=e.expression?.trim();if(!r)return;let o=s=>{let a=Jt(t);if(a._asor_refs||(a._asor_refs={}),s(a._asor_refs),a!==document.documentElement){let u=g(a)||{};u.$refs=a._asor_refs,w(a,u)}},n=()=>o(s=>s[r]=t),i=()=>o(s=>delete s[r]);return n(),et(s=>{X(s)&&s===t&&i()})});var xe=(t,e)=>{if(b(t))return t;if(!_(t)||!t.trim())return{};try{let r=St(e,`(${t})`,{});if(b(r))return r;c(`Invalid data attribute: ${t}`,e,t)}catch(r){return c(`Error parsing data attribute: ${r.message}`,e,t),{}}};function ve(t){let e=t.match(/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/);if(!e)return null;let[,r,o]=e,n=r.replace(/^\(|\)$/g,"").split(",").map(i=>i.trim());return n.length===1?{item:n[0],items:o.trim()}:n.length===2?{item:n[0],key:n[1],items:o.trim()}:n.length===3?{item:n[0],key:n[1],index:n[2],items:o.trim()}:null}f("def",({el:t,directive:e})=>{try{let r=e.expression;r=r===""?"{}":r;let o=ge(r)?ye(r,t):xe(r,t);if(!o){c(`Failed to obtain data for a-def directive with expression: ${r}`,{el:t});return}let n=Dt(o,t);n.$store=V(),w(t,n),T(t);let i=P(t,()=>T(t));return()=>{i(),J(t),t.removeAttribute("a-def")}}catch(r){c("Error in a-def directive:",r,t)}});var vr={text:t=>t.textContent,html:t=>t.innerHTML,value:t=>t.value,checked:t=>t.checked,selected:t=>t.selected,class:t=>t.className},br=new Map([["text",(t,e)=>t.textContent=e??""],["html",(t,e)=>t.innerHTML=e??""],["value",(t,e)=>{t.value!==e&&(t.value=e??"")}],["checked",(t,e)=>t.checked=!!e],["disabled",(t,e)=>t.disabled=!!e],["readonly",(t,e)=>t.readOnly=!!e],["required",(t,e)=>t.required=!!e],["multiple",(t,e)=>t.multiple=!!e],["hidden",(t,e)=>t.hidden=!!e],["radio",(t,e)=>t.checked=t.value==e],["open",(t,e)=>t.open=!!e],["class",Dr],["style",Ar],["selected",_r],["multipleSelect",Ee],["contenteditable",(t,e)=>{t.innerHTML!==e&&(t.innerHTML=e)}],["number",(t,e)=>{t.value=e==null?"":Number(e)}]]);function be(t,e,r){if(!t)return;if(t.tagName==="SELECT"&&t.multiple&&e==="value"){Ee(t,r);return}let o=Er(t,e);Object.is(o,r)||wr(t,e,r)}function Er(t,e){return vr[e]?.(t)??t.getAttribute(e)}function wr(t,e,r){(br.get(e)||((o,n)=>o.setAttribute(e,n??"")))(t,r)}function Dr(t,e){if(_(e))t.className=e;else if(K(e))t.className=e.join(" ");else if(b(e))for(let[r,o]of Object.entries(e))r.includes(" ")?r.split(" ").forEach(n=>{t.classList.toggle(n.trim(),!!o)}):t.classList.toggle(r,!!o)}function Ar(t,e){_(e)?t.style.cssText=e:b(e)&&Object.assign(t.style,e)}function Tr(t,e,r){let o=Sr(t,r),n=t.closest("[a-def]");if(!n)return;let i=g(n);if(i){let s={...i,[e]:o};w(n,s),T(n)}}function Sr(t,e){return t.tagName==="SELECT"&&t.multiple?Array.from(t.selectedOptions).map(r=>r.value):t.type==="date"||t.type==="datetime-local"?t.valueAsDate:t.type==="checkbox"?e.target.checked:t.type==="file"?t.multiple?Array.from(t.files):t.files[0]:e.target.value}function _r(t,e){let r=Array.from(t.options);if(K(e))r.forEach(o=>o.selected=e.includes(o.value));else{let o=r.find(n=>n.value==e);o&&(o.selected=!0,t.value=o.value)}}function Ee(t,e){K(e)||(e=[e]),Array.from(t.options).forEach(r=>r.selected=e.includes(r.value))}function we(t,e){if(["INPUT","TEXTAREA","SELECT"].includes(t.tagName)){let r=t.type==="checkbox"||t.type==="radio"||t.type==="file"?"change":"input";return y(t,r,o=>Tr(t,e,o))}return null}f("bind",({el:t,directive:e})=>{let r=e.value||"text",o=e.expression;if(!o){c("Empty bind expression",null,t);return}let n=async()=>{let s=g(t),a=await x(t,o,{data:s});O(a)||v(async()=>{be(t,r,a),we(t,o)})};n();let i=R((s,a)=>{s.contains(t)&&a.startsWith(E)&&n()});return()=>i});f("init",({el:t,directive:e})=>{let r=e.expression?.trim();if(!r)return;let o=t.__asor_def||g(t);if(!o){c("No data found for a-init directive:",t);return}(async()=>await x(t,r,{data:o,$el:t}))()});f("effect",({el:t,directive:e})=>{let r=e.expression,o=async()=>{let s=t.__asor_def||g(t);if(!s)return;let a=await x(t,r,{data:s});if(h(a))return await a()},n,i=async()=>{n&&(n(),n=null);let s=await o();h(s)&&(n=s)};return i(),P(t,i)});f("confirm",({el:t,directive:e})=>{let r=e.expression,o=e.hasModifier("prompt");r=r.replaceAll("\\n",`
`),r===""&&(r="Are you sure?");let n=(i,s,a)=>{i?s():a()};t.__confirm_action=(i,s)=>{if(o){let[a,u]=r.split("|");u||c("Directives: You must provide an expectation with @confirm.prompt.");let d=prompt(a);n(d===u,i,s)}else n(confirm(r),i,s)}});function Ae(t){let e=document.getElementById("asor-error");e||(e=document.createElement("div"),e.id="asor-error",e.style.cssText=`
            position: fixed;
            width: 100vw;
            height: 100vh;
            padding: 50px;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 200000;
        `,e.addEventListener("click",()=>De(e)),e.tabIndex=0,document.body.prepend(e),document.body.style.overflow="hidden");let r=document.createElement("iframe");r.style.cssText=`
        background-color: #17161A;
        border-radius: 5px;
        width: 100%;
        height: 100%;
    `,e.innerHTML="",e.appendChild(r),r.contentWindow.document.open(),r.contentWindow.document.write(t),r.contentWindow.document.close(),e.addEventListener("keydown",o=>{o.key==="Escape"&&De(e)}),e.focus()}function De(t){t.outerHTML="",document.body.style.overflow="visible"}function Nt(t){return new Ct(t)}var Ct=class{constructor(e){this.formData=new FormData,this.hasFile=!1,this.errors=[],e.tagName==="FORM"?this.serializeForm(e):this.collectElementData(e),this.addDirectiveData(e)}collectElementData(e){let r=this.elementHandlers[e.tagName];r&&r.call(this,e)}elementHandlers={SELECT:this.handleSelect,TEXTAREA:this.handleTextArea,INPUT:this.handleInput,BUTTON:this.handleButton};handleSelect(e){e.multiple?Array.from(e.selectedOptions).forEach(r=>{this.formData.append(e.name,r.value)}):this.formData.append(e.name,e.value)}handleTextArea(e){this.formData.append(e.name,e.value)}handleInput(e){let r={checkbox:()=>this.formData.append(e.name,e.checked),radio:()=>{e.checked&&this.formData.append(e.name,e.value)},file:()=>{e.files.length>0&&(Array.from(e.files).forEach(o=>{this.formData.append(e.name,o)}),this.hasFile=!0)},date:()=>{let o=new Date(e.value);isNaN(o.getTime())||this.formData.append(e.name,o.toISOString())},number:()=>{let o=parseFloat(e.value);isNaN(o)||this.formData.append(e.name,o)},default:()=>this.formData.append(e.name,e.value)};(r[e.type]||r.default)()}handleButton(e){e.name&&(e.type==="submit"||e.type==="button")&&this.formData.append(e.name,e.value||e.textContent)}addDirectiveData(e){let r=m(e,"data");r&&this.formData.append(r.value,r.expression);let o=m(e,"add");if(o)try{let n=JSON.parse(o.expression);Object.entries(n).forEach(([i,s])=>{this.formData.append(i,s)})}catch(n){c("Error parsing add directive:",n)}}serializeForm(e){this.formData=new FormData(e),this.hasFile=Array.from(this.formData.values()).some(r=>r instanceof File)}toObject(){let e={};for(let[r,o]of this.formData.entries())e[r]?(Array.isArray(e[r])||(e[r]=[e[r]]),e[r].push(o)):e[r]=o;return e}toJSON(){return JSON.stringify(this.toObject())}get(){return this.formData}hasFiles(){return this.hasFile}getErrors(){return this.errors}};function Se(t){return m(t,"swap")?.expression||"innerHTML"}var Te={innerHTML:(t,e)=>{t.innerHTML=e},outerHTML:(t,e)=>{t.outerHTML=e},beforebegin:(t,e)=>{t.insertAdjacentHTML("beforebegin",e)},afterbegin:(t,e)=>{t.insertAdjacentHTML("afterbegin",e)},beforeend:(t,e)=>{t.insertAdjacentHTML("beforeend",e)},afterend:(t,e)=>{t.insertAdjacentHTML("afterend",e)},replace:(t,e)=>{t.replaceWith(...Mt(e))},append:(t,e)=>{t.append(...Mt(e))},prepend:(t,e)=>{t.prepend(...Mt(e))}};function st(t,e,r){try{v(()=>{(Te[r]||Te.innerHTML)(t,e)})}catch(o){c(`Error applying swap method "${r}":`,o)}}var Mt=t=>{let e=document.createElement("div");return e.innerHTML=t,e.childNodes};var j=new WeakMap;function _e(t){if(j.has(t))return j.get(t);let e=m(t,"target");if(e){let r=e.expression?.trim();if(r){let o=document.querySelector(r);if(o)return j.set(t,o),o;A(`Target element "${r}" not found. Using original element.`)}}return j.set(t,t),t}function Ce(t){let e=m(t,"target");e?.modifiers.includes("once")&&(t.removeAttribute(e.directive),j.delete(t))}var It=new Set,Ot=!1;async function Ne(t,e){let o=new DOMParser().parseFromString(e,"text/html"),n=_e(t),i=Se(n),s=o.body.innerHTML,a=n.cloneNode(!0);Mr(n,()=>{st(n,s,i),Cr(a,n),Nr(n),Ce(n)})}function Cr(t,e){let r=C(t),o=C(e);o.forEach(n=>{let i=r.find(s=>s.isEqualNode(n));if(i){let s=g(i);s&&w(n,s)}}),se(e,t),r.forEach(n=>{o.some(i=>i.isEqualNode(n))||Me(n)})}function Me(t){let e=g(t);e&&e.$refs&&Object.keys(e.$refs).forEach(r=>{e.$refs[r]===t&&delete e.$refs[r]}),J(t),Array.from(t.children).forEach(Me)}function Nr(t){m(t,"transition")&&l(t,"asor:transition",{visible:!0})}function Mr(t,e){It.add({el:t,updateFn:e}),Ir()}function Ir(){Ot||(Ot=!0,requestAnimationFrame(Or))}function Or(){v(()=>{for(let{el:t,updateFn:e}of It)e(t);It.clear()}),Ot=!1}var $t=new Map,Ie=()=>new Lt,Lt=class{async handleRequest(e,r,o){let n=this.buildRequestOptions(r,e);l(document,"asor:before-request",{method:r,url:o,options:n});try{let i=await this.fetchData(r,o,n,e);if(!i)return;await this.handleResponse(i,e)}catch(i){this.handlerError(i,e)}finally{l(document,"asor:after-request",{method:r,url:o,options:n})}}buildRequestOptions(e,r){let o={method:e.toUpperCase(),headers:this.buildHeaders(r)};if(["POST","PUT","PATCH"].includes(o.method)){let n=Nt(r);o.body=this.prepareRequestBody(r,n)}return o}buildHeaders(e){return{Accept:"text/html, application/xhtml+xml","X-Requested-With":"XMLHttpRequest","X-Current-URL":document.location.href,"X-Asor":"true","Content-Type":this.getContentType(e)}}getContentType(e){let r=Nt(e);return ht(e)||r.hasFiles()?void 0:m(e,"enctype")?.expression||"application/json"}prepareRequestBody(e,r){return ht(e)||r.hasFiles()?r.get():JSON.stringify(r.toObject())}async fetchData(e,r,o,n){l(document,"asor:before-send",{method:e,url:r,options:o}),l(document,"asor:send",{method:e,url:r,options:o});let i=`${e}:${r}`;if($t.has(i))return $t.get(i);let s=await fetch(r,o);if(!s.ok)return this.handlerError(`HTTP error! status: ${s.status}`,n),!1;let a=await s.text();return $t.set(i,a),a}async handleResponse(e,r){l(document,"asor:before-render",{response:e});let o=this.getTargetDirective(r);await Ne(o,e),l(document,"asor:render",{html:e})}getTargetDirective(e){let r=m(e,"target")?.expression;return r?document.querySelector(r):e}handlerError(e,r){c("XHR request failed:",r,e),Ae(e.message)}};async function at(t){return m(t,"confirm")?.expression?new Promise(r=>{h(t.__confirm_action)?t.__confirm_action(()=>r(!0),()=>r(!1)):r(!0)}):!0}function Oe(t,e){let r;return function(...o){clearTimeout(r),r=setTimeout(()=>t(...o),e)}}function $e(t,e){let r;return function(...o){r||(t.apply(this,o),r=!0,setTimeout(()=>r=!1,e))}}var Ft={enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,shift:16,ctrl:17,alt:18,meta:91},Pt=["shift","ctrl","alt","meta"],$r=["get","post","put","patch","delete"],W=new WeakMap,Re=t=>$r.includes(t.value?.toLowerCase())?t.value.toLowerCase():"get",Rt={form:"submit",select:"change",textarea:"input",button:"click",input:{button:"click",submit:"click",reset:"click",checkbox:"change",radio:"change",file:"change",date:"change",time:"change","datetime-local":"change"},default:"click"};function Fe(t){let e=t.tagName.toLowerCase(),r=(t.type||"").toLowerCase();return e==="input"?Rt.input[r]||"input":Rt[e]||(t.isContentEditable?"input":t.getAttribute("tabindex")!==null?"focus":Rt.default)}var ct=(t,e,r={})=>{let{preventDefault:o,stopPropagation:n,once:i,delay:s,throttleTime:a,passive:u,keyModifiers:d,self:p}={preventDefault:!1,stopPropagation:!1,once:!1,delay:0,throttleTime:0,passive:!1,keyModifiers:[],self:!1,...r},D=JSON.stringify({preventDefault:o,stopPropagation:n,once:i,delay:s,throttleTime:a,passive:u,keyModifiers:d,self:p});W.has(t)||W.set(t,new Map);let N=W.get(t);if(!N.has(D)){let Ve=async S=>{if(S.type==="intersect")return Le(()=>e(S),s,a);p&&S.target!==t||Fr(S)&&!Pr(S,d)||(o&&!u&&h(S.preventDefault)&&S.preventDefault(),n&&h(S.stopPropagation)&&S.stopPropagation(),Le(()=>Rr(t,S,e),s,a),i&&Lr(t,D))};N.set(D,Ve)}return N.get(D)},Le=(t,e,r)=>e>0?Oe(t,e)():r>0?$e(t,r)():t(),Lr=(t,e)=>{let r=W.get(t);r.delete(e),r.size===0&&W.delete(t)},Rr=async(t,e,r)=>{try{if(!await at(t))return;(h(r)?await r.call(t,e):!0)!==!1&&t.__xhr_handler&&!t.__xhr_request_in_progress&&await t.__xhr_handler.call(t,e)}catch(o){c("Error in event handler:",o,t)}},Fr=t=>t.type?.startsWith("key"),Pr=(t,e)=>e.every(r=>Pt.includes(r)?t[`${r}Key`]:t.keyCode===Ft[r]),Hr=(t,e,r={})=>{let o=new IntersectionObserver(n=>{n.forEach(i=>{if(i.isIntersecting)try{e(i,t),r.once&&o.unobserve(t),r.disconnect&&o.disconnect()}catch(s){c("Error in IntersectionObserver callback:",s)}})},r);return o.observe(t),()=>o.disconnect()},Pe=(t,e,r,o={})=>y(document,e,n=>{t.contains(n.target)||r(n)},o);var ut=(t,e,r)=>{let{rootMargin:o="0px",threshold:n=.1,once:i}=r;return Hr(t,(a,u)=>{let d={type:"intersect",detail:{entry:a,element:u},target:u};l(u,"intersect",d.detail)&&e.call(u,d)},{rootMargin:o,threshold:n,once:i,disconnect:i})};f("xhr",({el:t,directive:e,manager:r})=>{let o=e.expression,n=Re(e),i=Fe(t),s=async()=>{if(!t.__xhr_request_in_progress){t.__xhr_request_in_progress=!0;try{await Ie().handleRequest(t,n,o)}catch(u){c("XHR request failed:",u)}finally{t.__xhr_request_in_progress=!1}}},a=()=>{};if(r.hasDirective("on"))t.__xhr_handler=s;else{let u=ct(t,s,{preventDefault:!0,stopPropagation:!0});a=y(t,i,u)}return()=>{a(),delete t.__xhr_handler,delete t.__xhr_request_in_progress}});function He(t,e){if(!(t instanceof Map))return e;for(let[,r]of t){let o=b(r)?r.value:r;if(_(o)){let n=ft(o);if(n!==null)return n}}return e}function ft(t){let e=/^(\d+)(ms|s)$/;if(_(t)&&e.test(t)){let[,r,o]=t.match(e);return o==="ms"?Number(r):Number(r)*1e3}return null}f("on",({el:t,directive:e})=>{let{modifiers:r,expression:o,value:n}=e,i=n?n.split(",").map(a=>a.trim()):[];if(i.length===0){c("No event specified for a-on directive in element: ",t);return}let s={preventDefault:r?.has("prevent")||!1,stopPropagation:r?.has("stop")||!1,once:r?.has("once")||!1,capture:r?.has("capture")||!1,passive:r?.has("passive")||!1,self:r?.has("self")||!1,window:r?.has("window")||!1,document:r?.has("document")||!1,outside:r?.has("outside")||!1,rootMargin:r?.get("rootMargin")?.value,threshold:r?.get("threshold")?.value,delay:ft(r?.get("debounce")?.value||"0"),throttle:ft(r?.get("throttle")?.value||"0"),keyModifiers:Array.from(r?.keys()||[]).filter(a=>a in Ft||Pt.includes(a))};try{let u=ct(t,async p=>await x(t,o,{$event:p,$el:t}),s),d=i.map(p=>p==="intersect"?ut(t,u,s):qr(t,p,u,s));return()=>d.forEach(p=>p())}catch(a){c(`Error evaluating expression in a-on directive: ${a.message}`,t)}});function qr(t,e,r,o){return o.window?y(window,e,r,o):o.document?y(document,e,r,o):o.outside&&e==="click"?Pe(t,e,r,o):y(t,e,r,o)}async function Ur(t,e,r,o,n,i,s){let a=document.createElement("template");a.innerHTML=t.trim();let u=a.content.firstElementChild||a.content.firstChild;if(!u)return c("Invalid template in a-for directive",s),null;let d={...n,[i.item]:e,[i.key||"key"]:r,[i.index||"index"]:r,length:o,parent:n};w(u,d),T(u);let p=m(u,"if");if(p&&!await x(u,p.expression,d))return null;let D=m(u,"show");return D&&(u.style.display=await x(u,D.expression,d)?"":"none"),C(u).forEach(N=>{ie(N)&&G(N)}),u}async function qe(t,e,r,o,n){if(e==null){A("Items is null or undefined in appendItems");return}let i=Array.isArray(e),s=i?e:b(e)?Object.entries(e):[];for(let a=0;a<s.length;a++){let[u,d]=i?[a,s[a]]:s[a],p=await Ur(o,d,u,s.length,r,n,t);p&&t.appendChild(p)}}f("for",({el:t,directive:e})=>{let r=ve(e.expression);if(!r){c("Invalid expression for a-for directive",t);return}let o=t.innerHTML;t.innerHTML="";let n=()=>{v(async()=>{let s=g(t.parentElement);if(!s){A("No parent data found for a-for directive",t);return}let a=await x(t.parentElement,r.items,s);if(O(a)){A(`${r.items} is not defined`,t);return}t.innerHTML="",await qe(t,a,s,o,r)})};n();let i=R((s,a)=>{s===t.parentElement&&a.startsWith(E)&&n()});return()=>i()});f("if",({el:t,directive:e})=>{let{expression:r}=e,o=document.createComment(`if: ${r}`),n=!1,i=v(()=>{let s=x(t,r);s&&!n&&t.parentNode?(t.parentNode.insertBefore(o,t.nextSibling),n=!0):!s&&n&&t.parentNode&&(t.parentNode.replaceChild(o,t),n=!1)});return t.parentNode&&t.parentNode.insertBefore(o,t.nextSibling),()=>{i(),o.parentNode&&o.remove(),n&&t.parentNode&&t.remove()}});f("show",({el:t,directive:e})=>{let{expression:r,modifiers:o}=e,n=async()=>{try{let s=await x(t,r);O(s)||Vr(t,s,o.has("important"))}catch(s){console.error("Error updating visibility for element:",t,s)}};return n(),R((s,a)=>{s.contains(t)&&a.startsWith(E)&&n()})});function Vr(t,e,r){m(t,"transition")?l(t,"asor:transition",{visible:e}):v(()=>{t.style.display=e?"":"none",r&&t.style.setProperty("display",t.style.display,"important")})}var B=class t{static DEFAULT_OPTIONS={color:"#29d",height:"3px",duration:300,delay:300,zIndex:14062024,className:"asor-progress-bar"};constructor(e={}){this.options={...t.DEFAULT_OPTIONS,...e},this.bar=null,this.visible=!1,this.timeout=null,this.value=0,this.trickleInterval=null}show(){this.visible||(this.visible=!0,this.value=0,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.createBar(),this.trickle()},this.options.delay))}hide(){this.visible&&(clearTimeout(this.timeout),clearInterval(this.trickleInterval),this.visible=!1,this.setValue(100),this.timeout=setTimeout(()=>{this.removeBar(),this.value=0},this.options.duration))}setValue(e){this.value=Math.min(100,Math.max(0,e)),this.bar&&(this.bar.style.width=`${this.value}%`,this.updateARIA())}trickle(){clearInterval(this.trickleInterval),this.trickleInterval=setInterval(()=>{let e=100-this.value,r=.02*Math.pow(1-Math.sqrt(e),2);this.setValue(this.value+r)},100)}createBar(){this.bar||(this.bar=document.createElement("div"),this.bar.className=this.options.className,this.bar.style.cssText=`
            position: fixed;
            top: 0;
            left: 0;
            width: 0;
            height: ${this.options.height};
            background-color: ${this.options.color};
            z-index: ${this.options.zIndex};
            transition: width ${this.options.duration}ms ease-out;
            box-shadow: 0 0 10px ${this.options.color}, 0 0 5px ${this.options.color};
            pointer-events: none;
        `,this.setAccessibility(),document.body.appendChild(this.bar))}removeBar(){this.bar&&this.bar.parentNode&&(this.bar.parentNode.removeChild(this.bar),this.bar=null)}setAccessibility(){this.bar&&(this.bar.setAttribute("role","progressbar"),this.bar.setAttribute("aria-valuemin","0"),this.bar.setAttribute("aria-valuemax","100"),this.updateARIA())}updateARIA(){this.bar&&(this.bar.setAttribute("aria-valuenow",Math.round(this.value)),this.bar.setAttribute("aria-label",`Progress: ${Math.round(this.value)}%`))}static injectStyles(){let e=document.createElement("style");e.textContent=`
            @keyframes asor-progress-bar-pulse {
                0% { box-shadow: 0 0 10px ${t.DEFAULT_OPTIONS.color}, 0 0 5px ${t.DEFAULT_OPTIONS.color}; }
                50% { box-shadow: 0 0 20px ${t.DEFAULT_OPTIONS.color}, 0 0 10px ${t.DEFAULT_OPTIONS.color}; }
                100% { box-shadow: 0 0 10px ${t.DEFAULT_OPTIONS.color}, 0 0 5px ${t.DEFAULT_OPTIONS.color}; }
            }
            .${t.DEFAULT_OPTIONS.className} {
                animation: asor-progress-bar-pulse 1.5s infinite ease-in-out;
            }
        `;let r=Kt("csp-nonce");r&&(e.nonce=r),document.head.appendChild(e)}};B.injectStyles();var Ue=50,dt=class{constructor(){this.progressBar=new B({delay:250}),this.cache=new Map,this.scrollPositions=new Map,this.currentRequest=null,this.executedScripts=new Set,window.addEventListener("popstate",this.handlePopState.bind(this))}handleNavigate=async e=>{if(this.shouldInterceptClick(e))return;e.preventDefault();let r=e.currentTarget.href||e.currentTarget.getAttribute("href");if(!r){c("No URL found for navigation.");return}await this.navigate(r)};shouldInterceptClick=e=>e.which>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;handlePopState=async()=>{let e=window.location.href,r=new URL(e,document.baseURI).href;if(this.cache.has(r)){let o=this.cache.get(r);await this.renderView(o.html),this.rehydrateBindings()}else await this.navigate(e,{pushState:!1})};rehydrateBindings(){document.querySelectorAll("*").forEach(e=>{let r=Array.from(e.attributes).filter(o=>o.name.startsWith(E));r.length>0&&r.forEach(o=>{try{let n=JSON.parse(sessionStorage.getItem(o.name)||"{}");w(e,n),T(e)}catch(n){c("Error when rehydrating bindings",n)}})})}async navigate(e,r={pushState:!0}){try{this.clearExecutedScripts(),this.progressBar.show(),this.saveScrollPosition(),l(document,"asor:navigating",{url:e});let o=await this.loadView(e);if(!o)return;let n=new URL(e,document.baseURI);r.pushState?await this.updateState("pushState",n.href):await this.updateState("replaceState",n.href),await this.renderView(o.html),this.restoreScrollPosition(e),this.animateTransition(),l(document,"asor:navigated",{url:n.href})}catch(o){c("Navigation error:",o)}finally{this.progressBar.hide()}}async loadView(e){let r=new URL(e,document.baseURI).href,o=r;if(this.cache.has(o))return this.cache.get(o);this.currentRequest&&this.currentRequest.abort();let n=new AbortController;this.currentRequest=n;try{let i=await fetch(r,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},signal:n.signal});i.ok||c(`Navigation to ${e} failed with state ${i.status}`);let a={html:await i.text()};return this.cache.set(o,a),this.trimCache(),a}catch(i){throw i.name==="AbortError"?A(`Solicitud a ${e} abortada`):c(`Error while navigating to ${e}:`,i),i}finally{this.currentRequest===n&&(this.currentRequest=null)}}trimCache(){this.cache.size>Ue&&Array.from(this.cache.keys()).slice(0,this.cache.size-Ue).forEach(r=>this.cache.delete(r))}saveScrollPosition(){let r=new URL(window.location.href).href;this.scrollPositions.set(r,{x:window.scrollX,y:window.scrollY})}restoreScrollPosition(e){let o=new URL(e).href;requestAnimationFrame(()=>{let n=this.scrollPositions.get(o)||{x:0,y:0};window.scrollTo(n.x,n.y)})}animateTransition(){document.body.style.opacity="0",requestAnimationFrame(()=>{document.body.style.transition="opacity 0.3s",document.body.style.opacity="1",setTimeout(()=>{document.body.style.transition=""},300)})}async updateState(e,r){try{history[e]({},document.title,r)}catch(o){o instanceof DOMException&&o.name==="SecurityError"&&c(`You cannot use asor:navigate with a link to a different root domain: ${r}`)}}async renderView(e){let o=new DOMParser().parseFromString(e,"text/html");document.title=o.title,await this.updateHead(o.head),await this.updateBody(o.body),this.executeScripts(document.head),this.executeScripts(document.body),window.Asor&&h(window.Asor.start)&&window.Asor.start(!0)}async updateHead(e){let r=document.head;Array.from(r.children).forEach(o=>{o.hasAttribute("data-persist")||o.remove()}),Array.from(e.children).forEach(o=>{o.hasAttribute("data-persist")||r.appendChild(o.cloneNode(!0))})}async updateBody(e){document.body.innerHTML=e.innerHTML}executeScripts(e){e.querySelectorAll("script").forEach(r=>{let o=document.createElement("script");Array.from(r.attributes).forEach(n=>o.setAttribute(n.name,n.value)),r.src?this.executedScripts.has(r.src)||(o.src=r.src,this.executedScripts.add(r.src)):(o.textContent=r.textContent,this.executedScripts.add(r.textContent)),r.parentNode.replaceChild(o,r)})}clearExecutedScripts(){this.executedScripts.clear()}async preloadView(e){let r=new URL(e,document.baseURI).href,o=r;if(!this.cache.has(o))try{let n=await fetch(r,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},signal:AbortSignal.timeout(1e4)});n.ok||c(`Precarga de ${e} fall\xF3 con el estado ${n.status}`);let i=await n.text();this.cache.set(o,{html:i}),this.trimCache()}catch(n){c("Error en la precarga:",n)}}};var z;f("navigate",({el:t,directive:e})=>{if(z||(z=new dt),t.hasNavigateListener)return;t.hasNavigateListener=!0;let r=!1;y(t,"click",async n=>{if(!r){r=!0,n.type==="click"&&n.preventDefault();try{await at(t)&&await z.handleNavigate(n)}catch(i){c("Navigation error:",i)}finally{r=!1}}}),e.hasModifier("lazy")?kr(t,e):e.hasModifier("hover")&&jr(t)});function kr(t,e){return ut(t,()=>{let o=t.getAttribute("href");o&&z.preloadView(o)},{rootMargin:e.getModifierValue("margin")||"90px",once:e.hasModifier("once")})}function jr(t){y(t,"mouseenter",()=>{let r=t.getAttribute("href");r&&z.preloadView(r)})}f("transition",({el:t,directive:e})=>{let r=zr(e),o=!1,n=null,i=u=>{if(o||u===n)return;o=!0,n=u;let d=u?"enter":"leave",p=u?r.enterDuration:r.leaveDuration;v(()=>{r.useClasses?Wr(t,d,p):Br(t,u,r)}),setTimeout(()=>{o=!1,u||(t.style.display="none")},p)},a=y(t,"asor:transition",u=>{let d=u.detail.visible;d!==n&&(d&&(t.style.display=""),i(d))});return n=window.getComputedStyle(t).display!=="none",n||(t.style.display="none"),a});function Wr(t,e,r){v(()=>{let o=m(t,`transition:${e}`)?.expression,n=m(t,`transition:${e}-start`)?.expression,i=m(t,`transition:${e}-end`)?.expression;o&&t.classList.add(o),n&&(t.classList.add(n),requestAnimationFrame(()=>{requestAnimationFrame(()=>{t.classList.remove(n),i&&t.classList.add(i)})})),setTimeout(()=>{o&&t.classList.remove(o),i&&t.classList.remove(i)},r)})}function Br(t,e,r){v(()=>{t.style.transition="none",t.offsetWidth,t.style.opacity=e?r.initialOpacity:"1",r.scale&&(t.style.transform=`scale(${e?r.initialScale:"1"})`),t.offsetWidth,t.style.transition=`all ${e?r.enterDuration:r.leaveDuration}ms ${r.easing}`,t.style.opacity=e?"1":r.initialOpacity,r.scale&&(t.style.transform=`scale(${e?"1":r.initialScale})`),r.origin!=="center"&&(t.style.transformOrigin=r.origin)})}function zr(t){let e={enterDuration:300,leaveDuration:300,delay:0,easing:"ease",opacity:!0,scale:!1,initialOpacity:"0",initialScale:"0.95",useClasses:!1,origin:"center"},r=new Map([["duration","enterDuration"],["enter","enterDuration"],["leave","leaveDuration"],["delay","delay"]]);return t.modifiers.forEach((o,n)=>{r.has(n)?(e[r.get(n)]=He(new Map([[n,o]]),e[r.get(n)]),n==="duration"&&(e.leaveDuration=e.enterDuration)):["ease","ease-in","ease-out","ease-in-out","linear"].includes(n)?e.easing=n:n==="opacity"?(e.opacity=!0,e.scale=!1):n==="scale"?(e.scale=!0,e.opacity=o!=="false",o&&o!=="true"&&(e.initialScale=parseFloat(o)/100)):n==="origin"&&(e.origin=o||"center")}),(m(t.el,"transition:enter")||m(t.el,"transition:leave"))&&(e.useClasses=!0),e}function I(t,e,r,o=null){v(()=>{if(r=e.hasModifier("remove")?!r:r,e.hasModifier("class")){let n=e.expression.split(" ").filter(String);r?t.classList.add(...n):t.classList.remove(...n)}else if(e.hasModifier("attr"))r?t.setAttribute(e.expression,!0):t.removeAttribute(e.expression);else{let n=o??Yt(t,"display"),i=["inline","block","table","flex","grid","inline-flex"].find(s=>e.hasModifier(s))||"inline-block";i=e.hasModifier("remove")&&!r?n:i,t.style.display=r?i:"none"}})}f("loading",({el:t,directive:e})=>{let r={shortest:50,shorter:100,short:150,default:200,long:300,longer:500,longest:1e3},o=e.getAllModifiers().reduce((D,N)=>r[N.name]||D,r.default),n,i=!1,a=(D=>e.hasModifier("delay")&&!e.hasModifier("none")?()=>{n=setTimeout(()=>{D()},o)}:D)(()=>{i||(i=!0,I(t,e,!0))}),u=()=>{clearTimeout(n),i&&(i=!1,I(t,e,!1))},d=y(document,"asor:before-send",a),p=y(document,"asor:after-request",u);return()=>{d(),p(),clearTimeout(n)}});var Ht=new Set,qt=new Set;function Ut(){(navigator.onLine?qt:Ht).forEach(r=>r())}window.addEventListener("online",Ut);window.addEventListener("offline",Ut);typeof navigator.onLine<"u"&&Ut();f("offline",({el:t,directive:e})=>{let r=()=>I(t,e,!0),o=()=>I(t,e,!1);return Ht.add(r),qt.add(o),typeof navigator.onLine<"u"&&I(t,e,!navigator.onLine),()=>{Ht.delete(r),qt.delete(o)}});var Kr=5e3;f("stream",({el:t,directive:e})=>{let r=e.expression,o=m(t,"swap")?.expression||"innerHTML",n=null,i=()=>{n=new EventSource(r),t._stream=n,n.onopen=()=>l(t,"stream:open"),n.onmessage=a=>Xr(t,a,o),n.onerror=a=>Jr(t,a,i)},s=()=>{n&&(n.close(),n=null)};return i(),et(t,()=>s)});function Xr(t,e,r){st(t,e.data,r),l(t,"stream:message",{data:e.data})}function Jr(t,e,r){l(t,"stream:error",{error:e}),r(),setTimeout(r,Kr)}var Yr={on:jt,stop:At,store:pe,start:le,evaluate:x,directive:f,component:he,onDataChange:P,dispatchSelf:Bt,dispatchGlobal:Wt},Vt=Yr;window.Asor=Vt;queueMicrotask(()=>Vt.start());})();
