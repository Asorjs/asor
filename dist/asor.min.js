(()=>{var Ft=Object.defineProperty;var Pt=(e,t,r)=>t in e?Ft(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var qe=(e,t,r)=>(Pt(e,typeof t!="symbol"?t+"":t,r),r);var b=e=>e!==null&&typeof e=="object"&&!Array.isArray(e),h=e=>typeof e=="function",z=e=>Array.isArray(e),S=e=>typeof e=="string";var O=e=>e===void 0,B=e=>e instanceof Element;var fe=(e,t)=>JSON.stringify(e)===JSON.stringify(t);function T(e,t={},...r){Ue("Warning",e,t,...r)}function c(e,t={}){let r=typeof e=="string"?e:e.message||"Unknown error",n={message:r,...t};setTimeout(()=>Ue("Error",r,n),0)}function le(e,t={},...r){let{el:n,expression:o,message:i="",defaultValue:s=null,rethrow:a=!1,onError:u}=t;try{return e(...r)}catch(l){let p=`${i}
${l.message}`;if(c(p,{el:n,expression:o}),u&&h(u)&&u(l,{el:n,expression:o,message:i}),a)throw l;return s}}function Ue(e,t,r={},...n){let{el:o,expression:i,component:s}=r,a=new Date().toISOString(),u={message:t,el:o,expression:i,component:s,timestamp:a,additionalInfo:n},l=e.toLowerCase()==="error"?"#FF0000":"#FFA500";console.groupCollapsed(`%c[Asor ${e}]: ${t}`,`color: ${l}; font-weight: bold;`),console.log(u),console.groupCollapsed("Stack Trace"),console.trace(),console.groupEnd()}var de=new Map,y=(e,t,r,n={})=>{let o=de.get(t);o||(o=new Set,de.set(t,o)),o.add(r);let i=new AbortController;return e.addEventListener(t,r,{...n,signal:i.signal}),()=>{i.abort(),o.delete(r),o.size===0&&de.delete(t)}},d=(e,t,r,n={})=>{let o=new CustomEvent(t,{bubbles:!0,cancelable:!0,...n,detail:r});return o.__asor={name:t,detail:r,receivedBy:[]},e.dispatchEvent(o)},ke=(e,t)=>y(window,e,r=>r.__asor&&t(r)),Ve=(e,t)=>d(window,e,t),We=(e,t,r)=>d(e,t,r,{bubbles:!1});var je=(e,t)=>{for(;e&&e!==document.body;){if(t(e))return e;e=e.parentElement}return null},ze=e=>document.querySelector(`meta[name='${e}']`)?.getAttribute("content")||"";var Be=e=>je(e,t=>t.hasAttribute("a-def"))||document.body,Ke=e=>je(e,t=>t.dataset&&Object.keys(t.dataset).length>0||t.hasAttribute("a-def"))||document.body;var me=e=>e.tagName==="FORM";var Xe=(e,t)=>window.getComputedStyle(e).getPropertyValue(t);var Je=(e=36)=>Math.random().toString(e).substring(2,10);function C(e=document.body,t=["a-","@",":"]){let r=[],n=document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>Array.from(i.attributes).some(s=>t.some(a=>s.name.startsWith(a)))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}),o;for(;o=n.nextNode();)r.push(o);return r}var L=new WeakMap,E="data-a-",Ye=e=>Array.from(e.attributes).find(t=>t.name.startsWith(E))?.name||null,w=(e,t)=>B(e)?b(t)?(fe(L.get(e),t)||(L.set(e,t),e.__asor_def=t,Qe(e)),t):(c(`${t} must be a valid object`,e),null):(c("The element is not a valid HTML element",e),null);function g(e){for(;e;){if(e.__asor_def)return e.__asor_def;e=e.parentElement}return{}}var K=e=>{L.delete(e);let t=Ye(e);t&&e.removeAttribute(t),delete e.__asor_def};function _(e){try{if(!L.get(e))return;Qe(e)}catch(t){c("Error updating data for element",e,t)}}function Ge(e){try{let t=L.get(e),r=e.__asor_def;Ht(t,r)&&L.set(e,{...r})}catch(t){c("Error updating data for element",e,t)}}var Ht=(e,t)=>!fe(e,t);function Qe(e){try{(()=>{let r=Je(),n=Ye(e);n&&e.removeAttribute(n),e.setAttribute(`${E}${r}`,"")})()}catch(t){c("Error serializing data for element",e,t)}}var Ze=new WeakMap,tt=new Map,pe=new Map;function qt(e){let t=e.join("|");return pe.has(t)||pe.set(t,new RegExp(`^(?:${t})([^\\s.:]+)(?:\\.[^\\s.:]+)*(?::[^\\s]+)?\\s*`)),pe.get(t)}var Ut=e=>{if(!e)throw new Error("Directive name is required");return e.startsWith(":")?`a-bind:${e.slice(1)}`:e.startsWith("@")?`a-on:${e.slice(1)}`:e.startsWith("a-")?e:`a-${e}`},f=(e,t)=>tt.set(e,t),rt=()=>C().forEach(J);function J(e){if(!e)return c(`Undefined element: ${e}`);let t=X(e);t.directives.sort((r,n)=>et.get(r.name)-et.get(n.name)).forEach(r=>{let n=tt.get(r.name);n&&n({el:e,directive:r,manager:t})})}var nt=e=>Array.from(e.attributes).some(t=>t.name.startsWith(":")||t.name.startsWith("@")||t.name.startsWith("a-")),X=e=>{let t=Ze.get(e);if(!t){let r=Vt(e);t={el:e,directives:r,hasDirective:n=>r.some(o=>o.name===n),getDirective:n=>r.find(o=>o.name===n),delDirective:n=>t.directives=t.directives.filter(o=>o.name!==n)},Ze.set(e,t)}return t},kt=["ref","def","bind","init","confirm","xhr","on","effect","show","navigate","transition","for","if","loading","offline","stream"],et=new Map(kt.map((e,t)=>[e,t])),m=(e,t)=>{let r=X(e).getDirective(t);return r?{...r,name:t}:null},Vt=e=>{if(!e?.attributes)return c("Invalid element in extractDirectives"),[];let t=qt(["a-","@",":"]);return Array.from(e.attributes).filter(r=>t.test(r.name)).map(({name:r,value:n})=>Wt(e,r,n))},Wt=(e,t,r)=>{let n=Ut(t),{directiveName:o,directiveValue:i}=jt(n),s=zt(t);return{el:e,name:o,fullName:n,expression:r,value:i,modifiers:s,hasModifier:a=>s.has(a),getModifierValue:a=>s.get(a),getAllModifiers:()=>Array.from(s,([a,u])=>({name:a,value:u})),hasModifiers:()=>s.size>0,firstModifier:()=>{let[a,u]=s.entries().next().value||[];return a?{name:a,value:u}:null}}},jt=e=>{let t=/^a-(?:(on):)?([^:.]+)(?::([^.]+))?/,[,r,n,o]=e.match(t)||[];return{directiveName:r||n,directiveValue:r?n:o}},zt=e=>{let t=e.match(/\.[^.\]]+(?=[^\]]*$)/g)||[];return new Map(t.map(r=>{let[n,o]=r.slice(1).split("-");return[n,o===void 0?!0:o]}))};async function ot(e,t){let r=C(e),n=C(t);r.forEach(o=>{let i=n.find(s=>s.isEqualNode(o));if(!i||!Bt(o,i))J(o);else{let s=g(i);s&&w(o,s)}})}function Bt(e,t){let r=X(e),n=X(t);return r.directives.length!==n.directives.length?!1:r.directives.every((o,i)=>{let s=n.directives[i];return o.name===s.name&&o.expression===s.expression})}var it={CHILD_LIST:"childList",ATTRIBUTES:"attributes"},H={elementAdded:new Set,elementRemoved:new Set,attributeChanged:new Set},G=null,q=!1,Q=!1,he=class{constructor(){this.addedNodes=new Set,this.removedNodes=new Set,this.changedAttributes=new Map}add(t){if(t.type===it.CHILD_LIST)t.addedNodes.forEach(r=>r.nodeType===Node.ELEMENT_NODE&&this.addedNodes.add(r)),t.removedNodes.forEach(r=>r.nodeType===Node.ELEMENT_NODE&&this.removedNodes.add(r));else if(t.type===it.ATTRIBUTES&&t.attributeName.startsWith(E)){let r=t.target.getAttribute(t.attributeName);t.oldValue!==r&&this.changedAttributes.set(t.target,{attributeName:t.attributeName,oldValue:t.oldValue,newValue:r})}}process(t){let r=(o,i)=>{for(let s of o){if(t.timeRemaining()<=0&&!t.didTimeout)return!1;i(s),o.delete(s)}return!0},n=()=>{for(let[o,{attributeName:i,oldValue:s,newValue:a}]of this.changedAttributes){if(t.timeRemaining()<=0&&!t.didTimeout)return!1;H.attributeChanged.forEach(u=>Y(u,o,i,s,a)),Y(()=>Ge(o)),this.changedAttributes.delete(o)}return!0};return r(this.addedNodes,o=>H.elementAdded.forEach(i=>Y(i,o)))&&r(this.removedNodes,o=>H.elementRemoved.forEach(i=>Y(i,o)))&&n()}isEmpty(){return this.addedNodes.size===0&&this.removedNodes.size===0&&this.changedAttributes.size===0}},$=new he,Kt=()=>{if(Q)return;Q=!0;let e=t=>{$.process(t)?Q=!1:requestIdleCallback(e)};requestIdleCallback(e)},Xt=e=>{e.forEach(t=>$.add(t)),$.isEmpty()||Kt()},Y=(e,...t)=>{try{e(...t)}catch(r){c("Error in mutation observer callback:",e.toString(),r)}},ge=()=>{q||!document||(G||(G=new MutationObserver(Xt)),G.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),q=!0)},ye=()=>{q&&(G.disconnect(),q=!1)},xe=e=>t=>{if(h(t))return H[e].add(t),()=>H[e].delete(t);c(`Invalid callback provided to on${e.charAt(0).toUpperCase()+e.slice(1)}`)},un=xe("elementAdded"),Z=xe("elementRemoved"),R=xe("attributeChanged"),v=e=>{let t=q;t&&ye();try{e()}finally{t&&ge()}},st=()=>{$.addedNodes.clear(),$.removedNodes.clear(),$.changedAttributes.clear(),Q=!1};var F=new WeakMap,ve=new Set,ee=!1;function te(e,t){return F.has(e)||F.set(e,new Set),F.get(e).add(t),()=>{let r=F.get(e);r&&(r.delete(t),r.size===0&&F.delete(e))}}function re(e){ve.add(e),Jt()}function Jt(){ee||(ee=!0,queueMicrotask(()=>Yt()),ee=!1)}function Yt(){ve.forEach(e=>{_(e);let t=F.get(e);t&&t.forEach(r=>r())}),ve.clear(),ee=!1}var at="asor_persist_";function ct(e,t){let r=e.uniqueId||at+e,n=localStorage.getItem(r);if(n===null)return t;try{return JSON.parse(n)}catch(o){return T(`Error parsing stored value for key ${e}:`,o),t}}function be(e,t){let r=e.uniqueId||at+e;try{localStorage.setItem(r,JSON.stringify(t))}catch(n){c(`Error storing value for key ${e}:`,n)}}var U=new WeakMap;function Ee(e,t){if((!e||!b(e))&&(e={}),U.has(e))return U.get(e);let r=er(e,t),n=new Proxy(r,Gt(t));return U.set(e,n),n}function Gt(e){return{get(t,r,n){let o=Reflect.get(t,r,n);return o&&o.__isPersist?o.value:h(o)&&!r.startsWith("__")?Qt(o,e,n):o},set(t,r,n,o){if(Zt(t,r,n,e))return!0;let i=t[r];return Reflect.set(t,r,n,o),i!==n&&re(e),!0}}}function Qt(e,t,r){return function(...n){let o=e.apply(r,n);return re(t),o}}function Zt(e,t,r,n){if(e[t]&&e[t].__isPersist){let o=e[t].value;return e[t].value=r,be(t,r),o!==r&&re(n),!0}return!1}function er(e,t){let r={};return tr(e,r),rr(e,r,t),r}function tr(e,t){Object.keys(e).forEach(r=>{let n=Object.getOwnPropertyDescriptor(e,r);n&&typeof n.get=="function"&&Object.defineProperty(t,r,{get:n.get.bind(t),enumerable:!0,configurable:!0})})}function rr(e,t,r){Object.entries(e).forEach(([n,o])=>{o&&o.__isPersist?t[n]=nr(n,o):b(o)?t[n]=Ee(o,r):h(o)?t[n]=o:t[n]||(t[n]=o)})}function nr(e,t){let r=ct(e,t.initialValue);return r==null&&(r=t.initialValue),be(e,r),{__isPersist:!0,value:r}}function ut(e){let t=g(e);t&&U.has(t)&&U.delete(t)}var ne=!1;function ft(e=!1){if(ne&&!e){T("Asor is already initialized. Skipping re-initialization.");return}we();let t=()=>{st(),d(document,"asor:init"),d(document,"asor:initializing"),requestAnimationFrame(()=>{ge(),rt(),ne=!0,d(document,"asor:initialized")})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()}function we(e=null){!ne||(ye(),or(),window.asor&&delete window.asor,e&&h(e)&&e(),d(document,"asor:stopped"),ne=!1)}function or(){document.querySelectorAll("*").forEach(e=>{Array.from(e.attributes).filter(r=>r.name.startsWith(E)).forEach(r=>e.removeAttribute(r.name)),ut(e)})}var De={parseInt,parseFloat,isNaN,isFinite,encodeURIComponent,decodeURIComponent,encodeURI,decodeURI};function lt(e,t={}){let r=Be(e),n=g(e)||g(r)||{},o=r._asor_refs||{},i={$el:e,$event:t.$event||{},$refs:o,$root:{...r,dataset:r?{...r.dataset}:{}},$dispatch:(s,a)=>d(e,s,a),$persist:s=>({__isPersist:!0,initialValue:s})};return{...i,$data:new Proxy(n,{get(s,a){if(a in s)return s[a];if(a in i)return i[a];if(a in t)return t[a];if(a in De)return De[a]}}),...De,...t}}var k=new Map,ir=500,sr=(e,t)=>({el:e,expression:t,rethrow:!1,defaultValue:null,message:`Error evaluating expression: "${t}"`}),ar=e=>`
    with (__context) {
        with ($data) {
            return (${e});
        }
    }
`,cr=e=>`
    try {
        ${e}
    } catch (e) {
        if (e instanceof ReferenceError) return undefined;
        throw e;
    }
`,ur=e=>{let t=ar(e),r=cr(t);return new Function("__context",r)},fr=(e,t)=>{let r=Object.keys(t).sort().join(",");return`${e}::${r}`},lr=(e,t)=>{if(k.size>=ir){let r=k.keys().next().value;k.delete(r)}k.set(e,t)};function Te(e,t,r){let n=sr(e,t);if(h(t))return le(t,n,r);if(!S(t))return c(`Invalid expression type: ${typeof t}. Expected string or function.`,e,t),null;let o=lt(e,r),i=fr(t,o),s=k.get(i);return s||(s=ur(t),lr(i,s)),le(()=>s(o),n)}var x=(e,t,r={})=>Te(e,t,r);f("ref",({el:e,directive:t})=>{let r=t.expression?.trim();if(!r)return;let n=s=>{let a=Ke(e);if(a._asor_refs||(a._asor_refs={}),s(a._asor_refs),a!==document.documentElement){let u=g(a)||{};u.$refs=a._asor_refs,w(a,u)}},o=()=>n(s=>s[r]=e),i=()=>n(s=>delete s[r]);return o(),Z(s=>{B(s)&&s===e&&i()})});var dt=(e,t)=>{if(b(e))return e;if(!S(e)||!e.trim())return{};try{let r=Te(t,`(${e})`,{});if(b(r))return r;c(`Invalid data attribute: ${e}`,t,e)}catch(r){return c(`Error parsing data attribute: ${r.message}`,t,e),{}}};function mt(e){let t=e.match(/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/);if(!t)return null;let[,r,n]=t,o=r.replace(/^\(|\)$/g,"").split(",").map(i=>i.trim());return o.length===1?{item:o[0],items:n.trim()}:o.length===2?{item:o[0],key:o[1],items:n.trim()}:o.length===3?{item:o[0],key:o[1],index:o[2],items:n.trim()}:null}f("def",({el:e,directive:t})=>{try{let r=t.expression;r=r===""?"{}":r;let n=dt(r,e),o=Ee(n,e);return w(e,o),_(e),()=>K(e)}catch(r){c("Error in a-def directive:",r,e)}});var dr={text:e=>e.textContent,html:e=>e.innerHTML,value:e=>e.value,checked:e=>e.checked,selected:e=>e.selected,class:e=>e.className},mr=new Map([["text",(e,t)=>e.textContent=t??""],["html",(e,t)=>e.innerHTML=t??""],["value",(e,t)=>{e.value!==t&&(e.value=t??"")}],["checked",(e,t)=>e.checked=!!t],["disabled",(e,t)=>e.disabled=!!t],["readonly",(e,t)=>e.readOnly=!!t],["required",(e,t)=>e.required=!!t],["multiple",(e,t)=>e.multiple=!!t],["hidden",(e,t)=>e.hidden=!!t],["radio",(e,t)=>e.checked=e.value==t],["open",(e,t)=>e.open=!!t],["class",gr],["style",yr],["selected",br],["multipleSelect",ht],["contenteditable",(e,t)=>{e.innerHTML!==t&&(e.innerHTML=t)}],["number",(e,t)=>{e.value=t==null?"":Number(t)}]]);function pt(e,t,r){if(!e)return;if(e.tagName==="SELECT"&&e.multiple&&t==="value"){ht(e,r);return}let n=pr(e,t);Object.is(n,r)||hr(e,t,r)}function pr(e,t){return dr[t]?.(e)??e.getAttribute(t)}function hr(e,t,r){(mr.get(t)||((n,o)=>n.setAttribute(t,o??"")))(e,r)}function gr(e,t){if(S(t))e.className=t;else if(z(t))e.className=t.join(" ");else if(b(t))for(let[r,n]of Object.entries(t))r.includes(" ")?r.split(" ").forEach(o=>{e.classList.toggle(o.trim(),!!n)}):e.classList.toggle(r,!!n)}function yr(e,t){S(t)?e.style.cssText=t:b(t)&&Object.assign(e.style,t)}function xr(e,t,r){let n=vr(e,r),o=e.closest("[a-def]");if(!o)return;let i=g(o);if(i){let s={...i,[t]:n};w(o,s),_(o)}}function vr(e,t){return e.tagName==="SELECT"&&e.multiple?Array.from(e.selectedOptions).map(r=>r.value):e.type==="date"||e.type==="datetime-local"?e.valueAsDate:e.type==="checkbox"?t.target.checked:e.type==="file"?e.multiple?Array.from(e.files):e.files[0]:t.target.value}function br(e,t){let r=Array.from(e.options);if(z(t))r.forEach(n=>n.selected=t.includes(n.value));else{let n=r.find(o=>o.value==t);n&&(n.selected=!0,e.value=n.value)}}function ht(e,t){z(t)||(t=[t]),Array.from(e.options).forEach(r=>r.selected=t.includes(r.value))}function gt(e,t){if(["INPUT","TEXTAREA","SELECT"].includes(e.tagName)){let r=e.type==="checkbox"||e.type==="radio"||e.type==="file"?"change":"input";return y(e,r,n=>xr(e,t,n))}return null}f("bind",({el:e,directive:t})=>{let r=t.value||"text",n=t.expression;if(!n){c("Empty bind expression",null,e);return}let o=async()=>{let s=g(e),a=await x(e,n,{data:s});O(a)||v(async()=>{pt(e,r,a),gt(e,n)})};o();let i=R((s,a)=>{s.contains(e)&&a.startsWith(E)&&o()});return()=>i});f("init",({el:e,directive:t})=>{let r=t.expression?.trim();if(!r)return;let n=e.__asor_def||g(e);if(!n){c("No data found for a-init directive:",e);return}(async()=>await x(e,r,{data:n,$el:e}))()});f("effect",({el:e,directive:t})=>{let r=t.expression,n=async()=>{let s=e.__asor_def||g(e);if(!s)return;let a=await x(e,r,{data:s});if(h(a))return await a()},o,i=async()=>{o&&(o(),o=null);let s=await n();h(s)&&(o=s)};return i(),te(e,i)});f("confirm",({el:e,directive:t})=>{let r=t.expression,n=t.hasModifier("prompt");r=r.replaceAll("\\n",`
`),r===""&&(r="Are you sure?");let o=(i,s,a)=>{i?s():a()};e.__confirm_action=(i,s)=>{if(n){let[a,u]=r.split("|");u||c("Directives: You must provide an expectation with @confirm.prompt.");let l=prompt(a);o(l===u,i,s)}else o(confirm(r),i,s)}});function xt(e){let t=document.getElementById("asor-error");t||(t=document.createElement("div"),t.id="asor-error",t.style.cssText=`
            position: fixed;
            width: 100vw;
            height: 100vh;
            padding: 50px;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 200000;
        `,t.addEventListener("click",()=>yt(t)),t.tabIndex=0,document.body.prepend(t),document.body.style.overflow="hidden");let r=document.createElement("iframe");r.style.cssText=`
        background-color: #17161A;
        border-radius: 5px;
        width: 100%;
        height: 100%;
    `,t.innerHTML="",t.appendChild(r),r.contentWindow.document.open(),r.contentWindow.document.write(e),r.contentWindow.document.close(),t.addEventListener("keydown",n=>{n.key==="Escape"&&yt(t)}),t.focus()}function yt(e){e.outerHTML="",document.body.style.overflow="visible"}function Se(e){return new Ae(e)}var Ae=class{constructor(t){this.formData=new FormData,this.hasFile=!1,this.errors=[],t.tagName==="FORM"?this.serializeForm(t):this.collectElementData(t),this.addDirectiveData(t)}collectElementData(t){let r=this.elementHandlers[t.tagName];r&&r.call(this,t)}elementHandlers={SELECT:this.handleSelect,TEXTAREA:this.handleTextArea,INPUT:this.handleInput,BUTTON:this.handleButton};handleSelect(t){t.multiple?Array.from(t.selectedOptions).forEach(r=>{this.formData.append(t.name,r.value)}):this.formData.append(t.name,t.value)}handleTextArea(t){this.formData.append(t.name,t.value)}handleInput(t){let r={checkbox:()=>this.formData.append(t.name,t.checked),radio:()=>{t.checked&&this.formData.append(t.name,t.value)},file:()=>{t.files.length>0&&(Array.from(t.files).forEach(n=>{this.formData.append(t.name,n)}),this.hasFile=!0)},date:()=>{let n=new Date(t.value);isNaN(n.getTime())||this.formData.append(t.name,n.toISOString())},number:()=>{let n=parseFloat(t.value);isNaN(n)||this.formData.append(t.name,n)},default:()=>this.formData.append(t.name,t.value)};(r[t.type]||r.default)()}handleButton(t){t.name&&(t.type==="submit"||t.type==="button")&&this.formData.append(t.name,t.value||t.textContent)}addDirectiveData(t){let r=m(t,"data");r&&this.formData.append(r.value,r.expression);let n=m(t,"add");if(n)try{let o=JSON.parse(n.expression);Object.entries(o).forEach(([i,s])=>{this.formData.append(i,s)})}catch(o){c("Error parsing add directive:",o)}}serializeForm(t){this.formData=new FormData(t),this.hasFile=Array.from(this.formData.values()).some(r=>r instanceof File)}toObject(){let t={};for(let[r,n]of this.formData.entries())t[r]?(Array.isArray(t[r])||(t[r]=[t[r]]),t[r].push(n)):t[r]=n;return t}toJSON(){return JSON.stringify(this.toObject())}get(){return this.formData}hasFiles(){return this.hasFile}getErrors(){return this.errors}};function bt(e){return m(e,"swap")?.expression||"innerHTML"}var vt={innerHTML:(e,t)=>{e.innerHTML=t},outerHTML:(e,t)=>{e.outerHTML=t},beforebegin:(e,t)=>{e.insertAdjacentHTML("beforebegin",t)},afterbegin:(e,t)=>{e.insertAdjacentHTML("afterbegin",t)},beforeend:(e,t)=>{e.insertAdjacentHTML("beforeend",t)},afterend:(e,t)=>{e.insertAdjacentHTML("afterend",t)},replace:(e,t)=>{e.replaceWith(..._e(t))},append:(e,t)=>{e.append(..._e(t))},prepend:(e,t)=>{e.prepend(..._e(t))}};function oe(e,t,r){try{v(()=>{(vt[r]||vt.innerHTML)(e,t)})}catch(n){c(`Error applying swap method "${r}":`,n)}}var _e=e=>{let t=document.createElement("div");return t.innerHTML=e,t.childNodes};var V=new WeakMap;function Et(e){if(V.has(e))return V.get(e);let t=m(e,"target");if(t){let r=t.expression?.trim();if(r){let n=document.querySelector(r);if(n)return V.set(e,n),n;T(`Target element "${r}" not found. Using original element.`)}}return V.set(e,e),e}function wt(e){let t=m(e,"target");t?.modifiers.includes("once")&&(e.removeAttribute(t.directive),V.delete(e))}var Ne=new Set,Ce=!1;async function Dt(e,t){let n=new DOMParser().parseFromString(t,"text/html"),o=Et(e),i=bt(o),s=n.body.innerHTML,a=o.cloneNode(!0);Dr(o,()=>{oe(o,s,i),Er(a,o),wr(o),wt(o)})}function Er(e,t){let r=C(e),n=C(t);n.forEach(o=>{let i=r.find(s=>s.isEqualNode(o));if(i){let s=g(i);s&&w(o,s)}}),ot(t,e),r.forEach(o=>{n.some(i=>i.isEqualNode(o))||Tt(o)})}function Tt(e){let t=g(e);t&&t.$refs&&Object.keys(t.$refs).forEach(r=>{t.$refs[r]===e&&delete t.$refs[r]}),K(e),Array.from(e.children).forEach(Tt)}function wr(e){!m(e,"transition")||d(e,"asor:transition",{visible:!0})}function Dr(e,t){Ne.add({el:e,updateFn:t}),Tr()}function Tr(){Ce||(Ce=!0,requestAnimationFrame(Ar))}function Ar(){v(()=>{for(let{el:e,updateFn:t}of Ne)t(e);Ne.clear()}),Ce=!1}var Me=new Map,At=()=>new Ie,Ie=class{async handleRequest(t,r,n){let o=this.buildRequestOptions(r,t);d(document,"asor:before-request",{method:r,url:n,options:o});try{let i=await this.fetchData(r,n,o,t);if(!i)return;await this.handleResponse(i,t)}catch(i){this.handlerError(i,t)}finally{d(document,"asor:after-request",{method:r,url:n,options:o})}}buildRequestOptions(t,r){let n={method:t.toUpperCase(),headers:this.buildHeaders(r)};if(["POST","PUT","PATCH"].includes(n.method)){let o=Se(r);n.body=this.prepareRequestBody(r,o)}return n}buildHeaders(t){return{Accept:"text/html, application/xhtml+xml","X-Requested-With":"XMLHttpRequest","X-Current-URL":document.location.href,"X-Asor":"true","Content-Type":this.getContentType(t)}}getContentType(t){let r=Se(t);return me(t)||r.hasFiles()?void 0:m(t,"enctype")?.expression||"application/json"}prepareRequestBody(t,r){return me(t)||r.hasFiles()?r.get():JSON.stringify(r.toObject())}async fetchData(t,r,n,o){d(document,"asor:before-send",{method:t,url:r,options:n}),d(document,"asor:send",{method:t,url:r,options:n});let i=`${t}:${r}`;if(Me.has(i))return Me.get(i);let s=await fetch(r,n);if(!s.ok)return this.handlerError(`HTTP error! status: ${s.status}`,o),!1;let a=await s.text();return Me.set(i,a),a}async handleResponse(t,r){d(document,"asor:before-render",{response:t});let n=this.getTargetDirective(r);await Dt(n,t),d(document,"asor:render",{html:t})}getTargetDirective(t){let r=m(t,"target")?.expression;return r?document.querySelector(r):t}handlerError(t,r){c("XHR request failed:",r,t),xt(t.message)}};async function ie(e){return m(e,"confirm")?.expression?new Promise(r=>{h(e.__confirm_action)?e.__confirm_action(()=>r(!0),()=>r(!1)):r(!0)}):!0}function St(e,t){let r;return function(...n){clearTimeout(r),r=setTimeout(()=>e(...n),t)}}function _t(e,t){let r;return function(...n){r||(e.apply(this,n),r=!0,setTimeout(()=>r=!1,t))}}var Le={enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,shift:16,ctrl:17,alt:18,meta:91},$e=["shift","ctrl","alt","meta"],Sr=["get","post","put","patch","delete"],W=new WeakMap,Ct=e=>Sr.includes(e.value?.toLowerCase())?e.value.toLowerCase():"get",Oe={form:"submit",select:"change",textarea:"input",button:"click",input:{button:"click",submit:"click",reset:"click",checkbox:"change",radio:"change",file:"change",date:"change",time:"change","datetime-local":"change"},default:"click"};function Mt(e){let t=e.tagName.toLowerCase(),r=(e.type||"").toLowerCase();return t==="input"?Oe.input[r]||"input":Oe[t]||(e.isContentEditable?"input":e.getAttribute("tabindex")!==null?"focus":Oe.default)}var se=(e,t,r={})=>{let{preventDefault:n,stopPropagation:o,once:i,delay:s,throttleTime:a,passive:u,keyModifiers:l,self:p}={preventDefault:!1,stopPropagation:!1,once:!1,delay:0,throttleTime:0,passive:!1,keyModifiers:[],self:!1,...r},D=JSON.stringify({preventDefault:n,stopPropagation:o,once:i,delay:s,throttleTime:a,passive:u,keyModifiers:l,self:p});W.has(e)||W.set(e,new Map);let M=W.get(e);if(!M.has(D)){let Rt=async A=>{if(A.type==="intersect")return Nt(()=>t(A),s,a);p&&A.target!==e||Cr(A)&&!Mr(A,l)||(n&&!u&&h(A.preventDefault)&&A.preventDefault(),o&&h(A.stopPropagation)&&A.stopPropagation(),Nt(()=>Nr(e,A,t),s,a),i&&_r(e,D))};M.set(D,Rt)}return M.get(D)},Nt=(e,t,r)=>t>0?St(e,t)():r>0?_t(e,r)():e(),_r=(e,t)=>{let r=W.get(e);r.delete(t),r.size===0&&W.delete(e)},Nr=async(e,t,r)=>{try{if(!await ie(e))return;(h(r)?await r.call(e,t):!0)!==!1&&e.__xhr_handler&&!e.__xhr_request_in_progress&&await e.__xhr_handler.call(e,t)}catch(n){c("Error in event handler:",n,e)}},Cr=e=>e.type?.startsWith("key"),Mr=(e,t)=>t.every(r=>$e.includes(r)?e[`${r}Key`]:e.keyCode===Le[r]),Ir=(e,t,r={})=>{let n=new IntersectionObserver(o=>{o.forEach(i=>{if(i.isIntersecting)try{t(i,e),r.once&&n.unobserve(e),r.disconnect&&n.disconnect()}catch(s){c("Error in IntersectionObserver callback:",s)}})},r);return n.observe(e),()=>n.disconnect()},It=(e,t,r,n={})=>y(document,t,o=>{e.contains(o.target)||r(o)},n);var ae=(e,t,r)=>{let{rootMargin:n="0px",threshold:o=.1,once:i}=r;return Ir(e,(a,u)=>{let l={type:"intersect",detail:{entry:a,element:u},target:u};d(u,"intersect",l.detail)&&t.call(u,l)},{rootMargin:n,threshold:o,once:i,disconnect:i})};f("xhr",({el:e,directive:t,manager:r})=>{let n=t.expression,o=Ct(t),i=Mt(e),s=async()=>{if(!e.__xhr_request_in_progress){e.__xhr_request_in_progress=!0;try{await At().handleRequest(e,o,n)}catch(u){c("XHR request failed:",u)}finally{e.__xhr_request_in_progress=!1}}},a=()=>{};if(r.hasDirective("on"))e.__xhr_handler=s;else{let u=se(e,s,{preventDefault:!0,stopPropagation:!0});a=y(e,i,u)}return()=>{a(),delete e.__xhr_handler,delete e.__xhr_request_in_progress}});function Ot(e,t){if(!(e instanceof Map))return t;for(let[,r]of e){let n=b(r)?r.value:r;if(S(n)){let o=ce(n);if(o!==null)return o}}return t}function ce(e){let t=/^(\d+)(ms|s)$/;if(S(e)&&t.test(e)){let[,r,n]=e.match(t);return n==="ms"?Number(r):Number(r)*1e3}return null}f("on",({el:e,directive:t})=>{let{modifiers:r,expression:n,value:o}=t,i=o?o.split(",").map(a=>a.trim()):[];if(i.length===0){c("No event specified for a-on directive in element: ",e);return}let s={preventDefault:r?.has("prevent")||!1,stopPropagation:r?.has("stop")||!1,once:r?.has("once")||!1,capture:r?.has("capture")||!1,passive:r?.has("passive")||!1,self:r?.has("self")||!1,window:r?.has("window")||!1,document:r?.has("document")||!1,outside:r?.has("outside")||!1,rootMargin:r?.get("rootMargin")?.value,threshold:r?.get("threshold")?.value,delay:ce(r?.get("debounce")?.value||"0"),throttle:ce(r?.get("throttle")?.value||"0"),keyModifiers:Array.from(r?.keys()||[]).filter(a=>a in Le||$e.includes(a))};try{let u=se(e,async p=>await x(e,n,{$event:p,$el:e}),s),l=i.map(p=>p==="intersect"?ae(e,u,s):Or(e,p,u,s));return()=>l.forEach(p=>p())}catch(a){c(`Error evaluating expression in a-on directive: ${a.message}`,e)}});function Or(e,t,r,n){return n.window?y(window,t,r,n):n.document?y(document,t,r,n):n.outside&&t==="click"?It(e,t,r,n):y(e,t,r,n)}async function Lr(e,t,r,n,o,i,s){let a=document.createElement("template");a.innerHTML=e.trim();let u=a.content.firstElementChild||a.content.firstChild;if(!u)return c("Invalid template in a-for directive",s),null;let l={...o,[i.item]:t,[i.key||"key"]:r,[i.index||"index"]:r,length:n,parent:o};w(u,l),_(u);let p=m(u,"if");if(p&&!await x(u,p.expression,l))return null;let D=m(u,"show");return D&&(u.style.display=await x(u,D.expression,l)?"":"none"),C(u).forEach(M=>{nt(M)&&J(M)}),u}async function Lt(e,t,r,n,o){if(t==null){T("Items is null or undefined in appendItems");return}let i=Array.isArray(t),s=i?t:b(t)?Object.entries(t):[];for(let a=0;a<s.length;a++){let[u,l]=i?[a,s[a]]:s[a],p=await Lr(n,l,u,s.length,r,o,e);p&&e.appendChild(p)}}f("for",({el:e,directive:t})=>{let r=mt(t.expression);if(!r){c("Invalid expression for a-for directive",e);return}let n=e.innerHTML;e.innerHTML="";let o=()=>{v(async()=>{let s=g(e.parentElement);if(!s){T("No parent data found for a-for directive",e);return}let a=await x(e.parentElement,r.items,s);if(O(a)){T(`${r.items} is not defined`,e);return}e.innerHTML="",await Lt(e,a,s,n,r)})};o();let i=R((s,a)=>{s===e.parentElement&&a.startsWith(E)&&o()});return()=>i()});f("if",({el:e,directive:t})=>{let{expression:r}=t,n=document.createComment(`if: ${r}`),o=!1,i=v(()=>{let s=x(e,r);s&&!o&&e.parentNode?(e.parentNode.insertBefore(n,e.nextSibling),o=!0):!s&&o&&e.parentNode&&(e.parentNode.replaceChild(n,e),o=!1)});return e.parentNode&&e.parentNode.insertBefore(n,e.nextSibling),()=>{i(),n.parentNode&&n.remove(),o&&e.parentNode&&e.remove()}});f("show",({el:e,directive:t})=>{let{expression:r,modifiers:n}=t,o=async()=>{try{let s=await x(e,r);O(s)||$r(e,s,n.has("important"))}catch(s){console.error("Error updating visibility for element:",e,s)}};return o(),R((s,a)=>{s.contains(e)&&a.startsWith(E)&&o()})});function $r(e,t,r){m(e,"transition")?d(e,"asor:transition",{visible:t}):v(()=>{e.style.display=t?"":"none",r&&e.style.setProperty("display",e.style.display,"important")})}var N=class{constructor(t={}){this.options={...N.DEFAULT_OPTIONS,...t},this.bar=null,this.visible=!1,this.timeout=null,this.value=0,this.trickleInterval=null}show(){this.visible||(this.visible=!0,this.value=0,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.createBar(),this.trickle()},this.options.delay))}hide(){!this.visible||(clearTimeout(this.timeout),clearInterval(this.trickleInterval),this.visible=!1,this.setValue(100),this.timeout=setTimeout(()=>{this.removeBar(),this.value=0},this.options.duration))}setValue(t){this.value=Math.min(100,Math.max(0,t)),this.bar&&(this.bar.style.width=`${this.value}%`,this.updateARIA())}trickle(){clearInterval(this.trickleInterval),this.trickleInterval=setInterval(()=>{let t=100-this.value,r=.02*Math.pow(1-Math.sqrt(t),2);this.setValue(this.value+r)},100)}createBar(){this.bar||(this.bar=document.createElement("div"),this.bar.className=this.options.className,this.bar.style.cssText=`
            position: fixed;
            top: 0;
            left: 0;
            width: 0;
            height: ${this.options.height};
            background-color: ${this.options.color};
            z-index: ${this.options.zIndex};
            transition: width ${this.options.duration}ms ease-out;
            box-shadow: 0 0 10px ${this.options.color}, 0 0 5px ${this.options.color};
            pointer-events: none;
        `,this.setAccessibility(),document.body.appendChild(this.bar))}removeBar(){this.bar&&this.bar.parentNode&&(this.bar.parentNode.removeChild(this.bar),this.bar=null)}setAccessibility(){!this.bar||(this.bar.setAttribute("role","progressbar"),this.bar.setAttribute("aria-valuemin","0"),this.bar.setAttribute("aria-valuemax","100"),this.updateARIA())}updateARIA(){!this.bar||(this.bar.setAttribute("aria-valuenow",Math.round(this.value)),this.bar.setAttribute("aria-label",`Progress: ${Math.round(this.value)}%`))}static injectStyles(){let t=document.createElement("style");t.textContent=`
            @keyframes asor-progress-bar-pulse {
                0% { box-shadow: 0 0 10px ${N.DEFAULT_OPTIONS.color}, 0 0 5px ${N.DEFAULT_OPTIONS.color}; }
                50% { box-shadow: 0 0 20px ${N.DEFAULT_OPTIONS.color}, 0 0 10px ${N.DEFAULT_OPTIONS.color}; }
                100% { box-shadow: 0 0 10px ${N.DEFAULT_OPTIONS.color}, 0 0 5px ${N.DEFAULT_OPTIONS.color}; }
            }
            .${N.DEFAULT_OPTIONS.className} {
                animation: asor-progress-bar-pulse 1.5s infinite ease-in-out;
            }
        `;let r=ze("csp-nonce");r&&(t.nonce=r),document.head.appendChild(t)}},P=N;qe(P,"DEFAULT_OPTIONS",{color:"#29d",height:"3px",duration:300,delay:300,zIndex:14062024,className:"asor-progress-bar"});P.injectStyles();var $t=50,ue=class{constructor(){this.progressBar=new P({delay:250}),this.cache=new Map,this.scrollPositions=new Map,this.currentRequest=null,this.executedScripts=new Set,window.addEventListener("popstate",this.handlePopState.bind(this))}handleNavigate=async t=>{if(this.shouldInterceptClick(t))return;t.preventDefault();let r=t.currentTarget.href||t.currentTarget.getAttribute("href");if(!r){c("No se encontr\xF3 una URL para la navegaci\xF3n.");return}await this.navigate(r)};shouldInterceptClick=t=>t.which>1||t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;handlePopState=async t=>{let r=window.location.href,n=new URL(r,document.baseURI).href;if(this.cache.has(n)){let o=this.cache.get(n);await this.renderView(o.html),this.rehydrateBindings()}else await this.navigate(r,{pushState:!1})};rehydrateBindings(){document.querySelectorAll("*").forEach(t=>{let r=Array.from(t.attributes).filter(n=>n.name.startsWith(E));r.length>0&&r.forEach(n=>{try{let o=JSON.parse(sessionStorage.getItem(n.name)||"{}");w(t,o),_(t)}catch(o){c("Error al rehidratar las vinculaciones",o)}})})}async navigate(t,r={pushState:!0}){try{this.clearExecutedScripts(),this.progressBar.show(),this.saveScrollPosition(),d(document,"asor:navigating",{url:t});let n=await this.loadView(t);if(!n)return;let o=new URL(t,document.baseURI);r.pushState?await this.updateState("pushState",o.href):await this.updateState("replaceState",o.href),await this.renderView(n.html),this.restoreScrollPosition(t),this.animateTransition(),d(document,"asor:navigated",{url:o.href})}catch(n){c("Error de navegaci\xF3n:",n)}finally{this.progressBar.hide()}}async loadView(t){let r=new URL(t,document.baseURI).href,n=r;if(this.cache.has(n))return this.cache.get(n);this.currentRequest&&this.currentRequest.abort();let o=new AbortController;this.currentRequest=o;try{let i=await fetch(r,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},signal:o.signal});i.ok||c(`La navegaci\xF3n a ${t} fall\xF3 con el estado ${i.status}`);let a={html:await i.text()};return this.cache.set(n,a),this.trimCache(),a}catch(i){throw i.name==="AbortError"?T(`Solicitud a ${t} abortada`):c(`Error durante la navegaci\xF3n a ${t}:`,i),i}finally{this.currentRequest===o&&(this.currentRequest=null)}}trimCache(){this.cache.size>$t&&Array.from(this.cache.keys()).slice(0,this.cache.size-$t).forEach(r=>this.cache.delete(r))}saveScrollPosition(){let t=new URL(window.location.href);t.hash="";let r=t.href;this.scrollPositions.set(r,{x:window.scrollX,y:window.scrollY})}restoreScrollPosition(t){let r=new URL(t);r.hash="";let n=r.href;requestAnimationFrame(()=>{let o=this.scrollPositions.get(n)||{x:0,y:0};window.scrollTo(o.x,o.y)})}animateTransition(){document.body.style.opacity="0",requestAnimationFrame(()=>{document.body.style.transition="opacity 0.3s",document.body.style.opacity="1",setTimeout(()=>{document.body.style.transition=""},300)})}async updateState(t,r){try{history[t]({},document.title,r)}catch(n){n instanceof DOMException&&n.name==="SecurityError"&&c(`No se puede usar asor:navigate con un enlace a un dominio ra\xEDz diferente: ${r}`)}}async renderView(t){let n=new DOMParser().parseFromString(t,"text/html");document.title=n.title,await this.updateHead(n.head),await this.updateBody(n.body),this.executeScripts(document.head),this.executeScripts(document.body),window.Asor&&h(window.Asor.start)&&window.Asor.start(!0)}async updateHead(t){let r=document.head;Array.from(r.children).forEach(n=>{n.hasAttribute("data-persist")||n.remove()}),Array.from(t.children).forEach(n=>{n.hasAttribute("data-persist")||r.appendChild(n.cloneNode(!0))})}async updateBody(t){document.body.innerHTML=t.innerHTML}executeScripts(t){t.querySelectorAll("script").forEach(r=>{let n=document.createElement("script");Array.from(r.attributes).forEach(o=>n.setAttribute(o.name,o.value)),r.src?this.executedScripts.has(r.src)||(n.src=r.src,this.executedScripts.add(r.src)):(n.textContent=r.textContent,this.executedScripts.add(r.textContent)),r.parentNode.replaceChild(n,r)})}clearExecutedScripts(){this.executedScripts.clear()}async preloadView(t){let r=new URL(t,document.baseURI).href,n=r;if(!this.cache.has(n))try{let o=await fetch(r,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},signal:AbortSignal.timeout(1e4)});o.ok||c(`Precarga de ${t} fall\xF3 con el estado ${o.status}`);let i=await o.text();this.cache.set(n,{html:i}),this.trimCache()}catch(o){c("Error en la precarga:",o)}}};var j;f("navigate",({el:e,directive:t})=>{if(j||(j=new ue),e.hasNavigateListener)return;e.hasNavigateListener=!0;let r=!1;y(e,"click",async o=>{if(!r){r=!0,o.type==="click"&&o.preventDefault();try{await ie(e)&&await j.handleNavigate(o)}catch(i){c("Navigation error:",i)}finally{r=!1}}}),t.hasModifier("lazy")?Rr(e,t):t.hasModifier("hover")&&Fr(e)});function Rr(e,t){return ae(e,()=>{let n=e.getAttribute("href");n&&j.preloadView(n)},{rootMargin:t.getModifierValue("margin")||"90px",once:t.hasModifier("once")})}function Fr(e){y(e,"mouseenter",()=>{let r=e.getAttribute("href");r&&j.preloadView(r)})}f("transition",({el:e,directive:t})=>{let r=qr(t),n=!1,o=null,i=u=>{if(n||u===o)return;n=!0,o=u;let l=u?"enter":"leave",p=u?r.enterDuration:r.leaveDuration;v(()=>{r.useClasses?Pr(e,l,p):Hr(e,u,r)}),setTimeout(()=>{n=!1,u||(e.style.display="none")},p)},a=y(e,"asor:transition",u=>{let l=u.detail.visible;l!==o&&(l&&(e.style.display=""),i(l))});return o=window.getComputedStyle(e).display!=="none",o||(e.style.display="none"),a});function Pr(e,t,r){v(()=>{let n=m(e,`transition:${t}`)?.expression,o=m(e,`transition:${t}-start`)?.expression,i=m(e,`transition:${t}-end`)?.expression;n&&e.classList.add(n),o&&(e.classList.add(o),requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.classList.remove(o),i&&e.classList.add(i)})})),setTimeout(()=>{n&&e.classList.remove(n),i&&e.classList.remove(i)},r)})}function Hr(e,t,r){v(()=>{e.style.transition="none",e.offsetWidth,e.style.opacity=t?r.initialOpacity:"1",r.scale&&(e.style.transform=`scale(${t?r.initialScale:"1"})`),e.offsetWidth,e.style.transition=`all ${t?r.enterDuration:r.leaveDuration}ms ${r.easing}`,e.style.opacity=t?"1":r.initialOpacity,r.scale&&(e.style.transform=`scale(${t?"1":r.initialScale})`),r.origin!=="center"&&(e.style.transformOrigin=r.origin)})}function qr(e){let t={enterDuration:300,leaveDuration:300,delay:0,easing:"ease",opacity:!0,scale:!1,initialOpacity:"0",initialScale:"0.95",useClasses:!1,origin:"center"},r=new Map([["duration","enterDuration"],["enter","enterDuration"],["leave","leaveDuration"],["delay","delay"]]);return e.modifiers.forEach((n,o)=>{r.has(o)?(t[r.get(o)]=Ot(new Map([[o,n]]),t[r.get(o)]),o==="duration"&&(t.leaveDuration=t.enterDuration)):["ease","ease-in","ease-out","ease-in-out","linear"].includes(o)?t.easing=o:o==="opacity"?(t.opacity=!0,t.scale=!1):o==="scale"?(t.scale=!0,t.opacity=n!=="false",n&&n!=="true"&&(t.initialScale=parseFloat(n)/100)):o==="origin"&&(t.origin=n||"center")}),(m(e.el,"transition:enter")||m(e.el,"transition:leave"))&&(t.useClasses=!0),t}function I(e,t,r,n=null){v(()=>{if(r=t.hasModifier("remove")?!r:r,t.hasModifier("class")){let o=t.expression.split(" ").filter(String);r?e.classList.add(...o):e.classList.remove(...o)}else if(t.hasModifier("attr"))r?e.setAttribute(t.expression,!0):e.removeAttribute(t.expression);else{let o=n??Xe(e,"display"),i=["inline","block","table","flex","grid","inline-flex"].find(s=>t.hasModifier(s))||"inline-block";i=t.hasModifier("remove")&&!r?o:i,e.style.display=r?i:"none"}})}f("loading",({el:e,directive:t})=>{let r={shortest:50,shorter:100,short:150,default:200,long:300,longer:500,longest:1e3},n=t.getAllModifiers().reduce((D,M)=>r[M.name]||D,r.default),o,i=!1,a=(D=>t.hasModifier("delay")&&!t.hasModifier("none")?()=>{o=setTimeout(()=>{D()},n)}:D)(()=>{i||(i=!0,I(e,t,!0))}),u=()=>{clearTimeout(o),i&&(i=!1,I(e,t,!1))},l=y(document,"asor:before-send",a),p=y(document,"asor:after-request",u);return()=>{l(),p(),clearTimeout(o)}});var Re=new Set,Fe=new Set;function Pe(){(navigator.onLine?Fe:Re).forEach(r=>r())}window.addEventListener("online",Pe);window.addEventListener("offline",Pe);typeof navigator.onLine<"u"&&Pe();f("offline",({el:e,directive:t})=>{let r=()=>I(e,t,!0),n=()=>I(e,t,!1);return Re.add(r),Fe.add(n),typeof navigator.onLine<"u"&&I(e,t,!navigator.onLine),()=>{Re.delete(r),Fe.delete(n)}});var Ur=5e3;f("stream",({el:e,directive:t})=>{let r=t.expression,n=m(e,"swap")?.expression||"innerHTML",o=null,i=()=>{o=new EventSource(r),e._stream=o,o.onopen=()=>d(e,"stream:open"),o.onmessage=a=>kr(e,a,n),o.onerror=a=>Vr(e,a,i)},s=()=>{o&&(o.close(),o=null)};return i(),Z(e,()=>s)});function kr(e,t,r){oe(e,t.data,r),d(e,"stream:message",{data:t.data})}function Vr(e,t,r){d(e,"stream:error",{error:t}),r(),setTimeout(r,Ur)}var Wr={on:ke,stop:we,start:ft,evaluate:x,directive:f,onDataChange:te,dispatchSelf:We,dispatchGlobal:Ve},He=Wr;window.Asor=He;queueMicrotask(()=>He.start());})();
